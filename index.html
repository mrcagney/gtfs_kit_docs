

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GTFS Kit 12.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=733045d8"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            GTFS Kit
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="#document-introduction">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#authors">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="#conventions">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-modules">Module constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.helpers">Module helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.cleaners">Module cleaners</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.calendar">Module calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.routes">Module routes</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.shapes">Module shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.stop_times">Module stop_times</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.stops">Module stops</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.trips">Module trips</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.miscellany">Module miscellany</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-gtfs_kit.feed">Module feed</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">GTFS Kit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">GTFS Kit 12.0.1 documentation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gtfs-kit-version-documentation">
<h1>GTFS Kit 12.0.1 Documentation<a class="headerlink" href="#gtfs-kit-version-documentation" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
<span id="document-introduction"></span><section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>GTFS Kit is an open-source Python library for analyzing <a class="reference external" href="https://en.wikipedia.org/wiki/GTFS">General Transit Feed Specification (GTFS)</a> data in memory without a database.
It uses Pandas and GeoPandas to do the heavy lifting.
You can find and contribute to GTFS Kit’s source code in its project repository <a class="reference external" href="https://github.com/mrcagney/gtfs_kit">on Github</a>.</p>
<p>The functions/methods of GTFS Kit assume a valid GTFS feed but offer no inbuilt validation, because GTFS validation is complex and already solved by dedicated libraries.
So unless you know what you’re doing, use the <a class="reference external" href="https://gtfs-validator.mobilitydata.org/">Canonical GTFS Validator</a> before you analyze a feed with GTFS Kit.</p>
</section>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Alex Raichev, 2019-09</p></li>
</ul>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Install it from PyPI with UV, say, via <code class="docutils literal notranslate"><span class="pre">uv</span> <span class="pre">add</span> <span class="pre">gtfs_kit</span></code>.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p>See the <a class="reference external" href="https://github.com/mrcagney/gtfs_kit/blob/master/notebooks/examples.ipynb">Marimo notebook output on Github</a>.</p>
</section>
<section id="conventions">
<h2>Conventions<a class="headerlink" href="#conventions" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>In conformance with GTFS, dates are encoded as YYYYMMDD date strings, and times are encoded as HH:MM:SS time strings with the possibility that HH &gt; 24. <strong>Watch out</strong> for that possibility, because it has counterintuitive consequences; see e.g. <code class="xref py py-func docutils literal notranslate"><span class="pre">trips.is_active_trip()</span></code>, which is used in <a class="reference internal" href="#gtfs_kit.routes.compute_route_stats" title="gtfs_kit.routes.compute_route_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">routes.compute_route_stats()</span></code></a>,  <a class="reference internal" href="#gtfs_kit.stops.compute_stop_stats" title="gtfs_kit.stops.compute_stop_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">stops.compute_stop_stats()</span></code></a>, and <a class="reference internal" href="#gtfs_kit.miscellany.compute_network_stats" title="gtfs_kit.miscellany.compute_network_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">miscellany.compute_network_stats()</span></code></a>.</p></li>
<li><p>‘DataFrame’ and ‘Series’ refer to Pandas DataFrame and Series objects,
respectively</p></li>
</ul>
</section>
<span id="document-modules"></span><section id="module-gtfs_kit.constants">
<span id="module-constants"></span><h2>Module constants<a class="headerlink" href="#module-gtfs_kit.constants" title="Link to this heading"></a></h2>
<p>Constants useful across modules.</p>
<dl class="py data">
<dt class="sig sig-object py" id="gtfs_kit.constants.COLORS_SET2">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.constants.</span></span><span class="sig-name descname"><span class="pre">COLORS_SET2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['#66c2a5',</span> <span class="pre">'#fc8d62',</span> <span class="pre">'#8da0cb',</span> <span class="pre">'#e78ac3',</span> <span class="pre">'#a6d854',</span> <span class="pre">'#ffd92f',</span> <span class="pre">'#e5c494',</span> <span class="pre">'#b3b3b3']</span></em><a class="headerlink" href="#gtfs_kit.constants.COLORS_SET2" title="Link to this definition"></a></dt>
<dd><p>Colorbrewer 8-class Set2 colors</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="gtfs_kit.constants.DIST_UNITS">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.constants.</span></span><span class="sig-name descname"><span class="pre">DIST_UNITS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['ft',</span> <span class="pre">'mi',</span> <span class="pre">'m',</span> <span class="pre">'km']</span></em><a class="headerlink" href="#gtfs_kit.constants.DIST_UNITS" title="Link to this definition"></a></dt>
<dd><p>Valid distance units</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="gtfs_kit.constants.DTYPES">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.constants.</span></span><span class="sig-name descname"><span class="pre">DTYPES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'agency':</span> <span class="pre">{'agency_email':</span> <span class="pre">'string',</span> <span class="pre">'agency_fare_url':</span> <span class="pre">'string',</span> <span class="pre">'agency_id':</span> <span class="pre">'string',</span> <span class="pre">'agency_lang':</span> <span class="pre">'string',</span> <span class="pre">'agency_name':</span> <span class="pre">'string',</span> <span class="pre">'agency_phone':</span> <span class="pre">'string',</span> <span class="pre">'agency_timezone':</span> <span class="pre">'string',</span> <span class="pre">'agency_url':</span> <span class="pre">'string'},</span> <span class="pre">'attributions':</span> <span class="pre">{'agency_id':</span> <span class="pre">'string',</span> <span class="pre">'attribution_email':</span> <span class="pre">'string',</span> <span class="pre">'attribution_id':</span> <span class="pre">'string',</span> <span class="pre">'attribution_phone':</span> <span class="pre">'string',</span> <span class="pre">'attribution_url':</span> <span class="pre">'string',</span> <span class="pre">'is_authority':</span> <span class="pre">'Int32',</span> <span class="pre">'is_operator':</span> <span class="pre">'Int32',</span> <span class="pre">'is_producer':</span> <span class="pre">'Int32',</span> <span class="pre">'organization_name':</span> <span class="pre">'string',</span> <span class="pre">'route_id':</span> <span class="pre">'string',</span> <span class="pre">'trip_id':</span> <span class="pre">'string'},</span> <span class="pre">'calendar':</span> <span class="pre">{'end_date':</span> <span class="pre">'string',</span> <span class="pre">'friday':</span> <span class="pre">'Int32',</span> <span class="pre">'monday':</span> <span class="pre">'Int32',</span> <span class="pre">'saturday':</span> <span class="pre">'Int32',</span> <span class="pre">'service_id':</span> <span class="pre">'string',</span> <span class="pre">'start_date':</span> <span class="pre">'string',</span> <span class="pre">'sunday':</span> <span class="pre">'Int32',</span> <span class="pre">'thursday':</span> <span class="pre">'Int32',</span> <span class="pre">'tuesday':</span> <span class="pre">'Int32',</span> <span class="pre">'wednesday':</span> <span class="pre">'Int32'},</span> <span class="pre">'calendar_dates':</span> <span class="pre">{'date':</span> <span class="pre">'string',</span> <span class="pre">'exception_type':</span> <span class="pre">'Int32',</span> <span class="pre">'service_id':</span> <span class="pre">'string'},</span> <span class="pre">'fare_attributes':</span> <span class="pre">{'currency_type':</span> <span class="pre">'string',</span> <span class="pre">'fare_id':</span> <span class="pre">'string',</span> <span class="pre">'payment_method':</span> <span class="pre">'Int32',</span> <span class="pre">'price':</span> <span class="pre">'float',</span> <span class="pre">'transfer_duration':</span> <span class="pre">'Int16',</span> <span class="pre">'transfers':</span> <span class="pre">'Int32'},</span> <span class="pre">'fare_rules':</span> <span class="pre">{'contains_id':</span> <span class="pre">'string',</span> <span class="pre">'destination_id':</span> <span class="pre">'string',</span> <span class="pre">'fare_id':</span> <span class="pre">'string',</span> <span class="pre">'origin_id':</span> <span class="pre">'string',</span> <span class="pre">'route_id':</span> <span class="pre">'string'},</span> <span class="pre">'feed_info':</span> <span class="pre">{'feed_end_date':</span> <span class="pre">'string',</span> <span class="pre">'feed_lang':</span> <span class="pre">'string',</span> <span class="pre">'feed_publisher_name':</span> <span class="pre">'string',</span> <span class="pre">'feed_publisher_url':</span> <span class="pre">'string',</span> <span class="pre">'feed_start_date':</span> <span class="pre">'string',</span> <span class="pre">'feed_version':</span> <span class="pre">'string'},</span> <span class="pre">'frequencies':</span> <span class="pre">{'end_time':</span> <span class="pre">'string',</span> <span class="pre">'exact_times':</span> <span class="pre">'Int32',</span> <span class="pre">'headway_secs':</span> <span class="pre">'Int16',</span> <span class="pre">'start_time':</span> <span class="pre">'string',</span> <span class="pre">'trip_id':</span> <span class="pre">'string'},</span> <span class="pre">'routes':</span> <span class="pre">{'agency_id':</span> <span class="pre">'string',</span> <span class="pre">'route_color':</span> <span class="pre">'string',</span> <span class="pre">'route_desc':</span> <span class="pre">'string',</span> <span class="pre">'route_id':</span> <span class="pre">'string',</span> <span class="pre">'route_long_name':</span> <span class="pre">'string',</span> <span class="pre">'route_short_name':</span> <span class="pre">'string',</span> <span class="pre">'route_text_color':</span> <span class="pre">'string',</span> <span class="pre">'route_type':</span> <span class="pre">'Int32',</span> <span class="pre">'route_url':</span> <span class="pre">'string'},</span> <span class="pre">'shapes':</span> <span class="pre">{'shape_dist_traveled':</span> <span class="pre">'float',</span> <span class="pre">'shape_id':</span> <span class="pre">'string',</span> <span class="pre">'shape_pt_lat':</span> <span class="pre">'float',</span> <span class="pre">'shape_pt_lon':</span> <span class="pre">'float',</span> <span class="pre">'shape_pt_sequence':</span> <span class="pre">'Int32'},</span> <span class="pre">'stop_times':</span> <span class="pre">{'arrival_time':</span> <span class="pre">'string',</span> <span class="pre">'departure_time':</span> <span class="pre">'string',</span> <span class="pre">'drop_off_type':</span> <span class="pre">'Int32',</span> <span class="pre">'pickup_type':</span> <span class="pre">'Int32',</span> <span class="pre">'shape_dist_traveled':</span> <span class="pre">'float',</span> <span class="pre">'stop_headsign':</span> <span class="pre">'string',</span> <span class="pre">'stop_id':</span> <span class="pre">'string',</span> <span class="pre">'stop_sequence':</span> <span class="pre">'Int32',</span> <span class="pre">'timepoint':</span> <span class="pre">'Int32',</span> <span class="pre">'trip_id':</span> <span class="pre">'string'},</span> <span class="pre">'stops':</span> <span class="pre">{'location_type':</span> <span class="pre">'Int32',</span> <span class="pre">'parent_station':</span> <span class="pre">'string',</span> <span class="pre">'stop_code':</span> <span class="pre">'string',</span> <span class="pre">'stop_desc':</span> <span class="pre">'string',</span> <span class="pre">'stop_id':</span> <span class="pre">'string',</span> <span class="pre">'stop_lat':</span> <span class="pre">'float',</span> <span class="pre">'stop_lon':</span> <span class="pre">'float',</span> <span class="pre">'stop_name':</span> <span class="pre">'string',</span> <span class="pre">'stop_timezone':</span> <span class="pre">'string',</span> <span class="pre">'stop_url':</span> <span class="pre">'string',</span> <span class="pre">'wheelchair_boarding':</span> <span class="pre">'Int32',</span> <span class="pre">'zone_id':</span> <span class="pre">'string'},</span> <span class="pre">'transfers':</span> <span class="pre">{'from_stop_id':</span> <span class="pre">'string',</span> <span class="pre">'min_transfer_time':</span> <span class="pre">'Int16',</span> <span class="pre">'to_stop_id':</span> <span class="pre">'string',</span> <span class="pre">'transfer_type':</span> <span class="pre">'Int32'},</span> <span class="pre">'trips':</span> <span class="pre">{'bikes_allowed':</span> <span class="pre">'Int32',</span> <span class="pre">'block_id':</span> <span class="pre">'string',</span> <span class="pre">'direction_id':</span> <span class="pre">'Int32',</span> <span class="pre">'route_id':</span> <span class="pre">'string',</span> <span class="pre">'service_id':</span> <span class="pre">'string',</span> <span class="pre">'shape_id':</span> <span class="pre">'string',</span> <span class="pre">'trip_headsign':</span> <span class="pre">'string',</span> <span class="pre">'trip_id':</span> <span class="pre">'string',</span> <span class="pre">'trip_short_name':</span> <span class="pre">'string',</span> <span class="pre">'wheelchair_accessible':</span> <span class="pre">'Int32'}}</span></em><a class="headerlink" href="#gtfs_kit.constants.DTYPES" title="Link to this definition"></a></dt>
<dd><p>GTFS data types</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="gtfs_kit.constants.FEED_ATTRS">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.constants.</span></span><span class="sig-name descname"><span class="pre">FEED_ATTRS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['agency',</span> <span class="pre">'attributions',</span> <span class="pre">'calendar',</span> <span class="pre">'calendar_dates',</span> <span class="pre">'fare_attributes',</span> <span class="pre">'fare_rules',</span> <span class="pre">'feed_info',</span> <span class="pre">'frequencies',</span> <span class="pre">'routes',</span> <span class="pre">'shapes',</span> <span class="pre">'stops',</span> <span class="pre">'stop_times',</span> <span class="pre">'trips',</span> <span class="pre">'transfers',</span> <span class="pre">'dist_units']</span></em><a class="headerlink" href="#gtfs_kit.constants.FEED_ATTRS" title="Link to this definition"></a></dt>
<dd><p>Feed attributes</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="gtfs_kit.constants.WGS84">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.constants.</span></span><span class="sig-name descname"><span class="pre">WGS84</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'EPSG:4326'</span></em><a class="headerlink" href="#gtfs_kit.constants.WGS84" title="Link to this definition"></a></dt>
<dd><p>WGS84 coordinate reference system for Geopandas</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.helpers">
<span id="module-helpers"></span><h2>Module helpers<a class="headerlink" href="#module-gtfs_kit.helpers" title="Link to this heading"></a></h2>
<p>Functions useful across modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.almost_equal">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">almost_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.almost_equal" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if the given DataFrames are equal after
sorting their columns names, sorting their values, and
reseting their indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.combine_time_series">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">combine_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_by_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'route'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'stop'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.combine_time_series" title="Link to this definition"></a></dt>
<dd><p>Combine a dict of wide time series (one DataFrame per indicator, columns are entities)
into a single long-form time series with columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'datetime'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code> or <code class="docutils literal notranslate"><span class="pre">'stop_id'</span></code>: depending on <code class="docutils literal notranslate"><span class="pre">kind</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: present if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p>one column per indicator provided in <cite>series_by_indicator</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: if both <code class="docutils literal notranslate"><span class="pre">service_distance</span></code> and <code class="docutils literal notranslate"><span class="pre">service_duration</span></code> present</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then assume the original time series contains data
separated by trip direction; otherwise, assume not.
The separation is indicated by a suffix <code class="docutils literal notranslate"><span class="pre">'-0'</span></code> (direction 0) or <code class="docutils literal notranslate"><span class="pre">'-1'</span></code>
(direction 1) in the route ID or stop ID column values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.date_to_datestr">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">date_to_datestr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">date</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y%m%d'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.date_to_datestr" title="Link to this definition"></a></dt>
<dd><p>Convert a datetime.date to a formatted string.
Return <code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">is</span> <span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.datestr_to_date">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">datestr_to_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y%m%d'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">date</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.datestr_to_date" title="Link to this definition"></a></dt>
<dd><p>Convert a date string to a datetime.date.
Return <code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">is</span> <span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.downsample">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.downsample" title="Link to this definition"></a></dt>
<dd><p>Downsample the given stop, route,  or network time series,
(outputs of <a class="reference internal" href="#gtfs_kit.stops.compute_stop_time_series" title="gtfs_kit.stops.compute_stop_time_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">stops.compute_stop_time_series()</span></code></a>,
<a class="reference internal" href="#gtfs_kit.routes.compute_route_time_series" title="gtfs_kit.routes.compute_route_time_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">routes.compute_route_time_series()</span></code></a>, or
<a class="reference internal" href="#gtfs_kit.miscellany.compute_network_time_series" title="gtfs_kit.miscellany.compute_network_time_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">miscellany.compute_network_time_series()</span></code></a>,
respectively) to the given frequency (Pandas frequency string, e.g. ‘15Min’).</p>
<p>Return the given time series unchanged if the given frequency is
finer than the original frequency or the given frequncy is courser than a day.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.get_active_trips_df">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">get_active_trips_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.get_active_trips_df" title="Link to this definition"></a></dt>
<dd><p>Count the number of trips in <code class="docutils literal notranslate"><span class="pre">trip_times</span></code> that are active
at any given time.</p>
<p>Assume <code class="docutils literal notranslate"><span class="pre">trip_times</span></code> contains the columns</p>
<ul class="simple">
<li><p>start_time: start time of the trip in seconds past midnight</p></li>
<li><p>end_time: end time of the trip in seconds past midnight</p></li>
</ul>
<p>Return a Series whose index is times from midnight when trips
start and end and whose values are the number of active trips for that time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.get_convert_dist">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">get_convert_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_units_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_units_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.helpers.get_convert_dist" title="Link to this definition"></a></dt>
<dd><p>Return a function of the form</p>
<blockquote>
<div><p>distance in the units <code class="docutils literal notranslate"><span class="pre">dist_units_in</span></code> -&gt;
distance in the units <code class="docutils literal notranslate"><span class="pre">dist_units_out</span></code></p>
</div></blockquote>
<p>Only supports distance units in <code class="xref py py-const docutils literal notranslate"><span class="pre">constants.DIST_UNITS</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.get_max_runs">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">get_max_runs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.get_max_runs" title="Link to this definition"></a></dt>
<dd><p>Given a list of numbers, return a NumPy array of pairs
(start index, end index + 1) of the runs of max value.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_max_runs</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">array([[0, 1],</span>
<span class="go">       [3, 5]])</span>
</pre></div>
</div>
<p>Assume x is not empty.
Recipe comes from
<a class="reference external" href="http://stackoverflow.com/questions/1066758/find-length-of-sequences-of-identical-values-in-a-numpy-array">Stack Overflow</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.get_peak_indices">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">get_peak_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.get_peak_indices" title="Link to this definition"></a></dt>
<dd><p>Given an increasing list of times as seconds past midnight and a
list of trip counts at those respective times,
return a pair of indices i, j such that times[i] to times[j] is
the first longest time period such that for all i &lt;= x &lt; j,
counts[x] is the max of counts.
Assume times and counts have the same nonzero length.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_peak_indices</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
<span class="go">array([0, 1])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18000</span><span class="p">,</span> <span class="mi">21600</span><span class="p">,</span> <span class="mi">28800</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_peak_indices</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
<span class="go">array([0, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.get_segment_length">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">get_segment_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linestring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LineString</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Point</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.get_segment_length" title="Link to this definition"></a></dt>
<dd><p>Given a Shapely linestring and two Shapely points,
project the points onto the linestring, and return the distance
along the linestring between the two points.
If <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">is</span> <span class="pre">None</span></code>, then return the distance from the start of the
linestring to the projection of <code class="docutils literal notranslate"><span class="pre">p</span></code>.
The distance is measured in the native coordinates of the linestring.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.is_metric">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">is_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.is_metric" title="Link to this definition"></a></dt>
<dd><p>Return True if the given distance units equals ‘m’ or ‘km’;
otherwise return False.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.is_not_null">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">is_not_null</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.is_not_null" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the given DataFrame has a column of the given
name (string), and there exists at least one non-NaN value in that
column; return <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.longest_subsequence">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">longest_subsequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'strictly'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'increasing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.helpers.longest_subsequence" title="Link to this definition"></a></dt>
<dd><p>Return the longest increasing subsequence of <cite>seq</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>sequence object</em>) – Can be any sequence, like <cite>str</cite>, <cite>list</cite>, <cite>numpy.array</cite>.</p></li>
<li><p><strong>mode</strong> (<em>{'strict'</em><em>, </em><em>'strictly'</em><em>, </em><em>'weak'</em><em>, </em><em>'weakly'}</em><em>, </em><em>optional</em>) – If set to ‘strict’, the subsequence will contain unique elements.
Using ‘weak’ an element can be repeated many times.
Modes ending in -ly serve as a convenience to use with <cite>order</cite> parameter,
because <cite>longest_sequence(seq, ‘weakly’, ‘increasing’)</cite> reads better.
The default is ‘strict’.</p></li>
<li><p><strong>order</strong> (<em>{'increasing'</em><em>, </em><em>'decreasing'}</em><em>, </em><em>optional</em>) – By default return the longest increasing subsequence, but it is possible
to return the longest decreasing sequence as well.</p></li>
<li><p><strong>key</strong> (<em>function</em><em>, </em><em>optional</em>) – Specifies a function of one argument that is used to extract a comparison
key from each list element (e.g., <cite>str.lower</cite>, <cite>lambda x: x[0]</cite>).
The default value is <cite>None</cite> (compare the elements directly).</p></li>
<li><p><strong>index</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to <cite>True</cite>, return the indices of the subsequence, otherwise return
the elements. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>elements</strong> (<em>list, optional</em>) – A <cite>list</cite> of elements of the longest subsequence.
Returned by default and when <cite>index</cite> is set to <cite>False</cite>.</p></li>
<li><p><strong>indices</strong> (<em>list, optional</em>) – A <cite>list</cite> of indices pointing to elements in the longest subsequence.
Returned when <cite>index</cite> is set to <cite>True</cite>.</p></li>
<li><p>Taken from <a class="reference external" href="https://stackoverflow.com/a/38337443">this Stack Overflow answer</a>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.make_html">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">make_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.make_html" title="Link to this definition"></a></dt>
<dd><p>Convert the given dictionary into an HTML table (string) with
two columns: keys of dictionary, values of dictionary.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.make_ids">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">make_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'id_'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.helpers.make_ids" title="Link to this definition"></a></dt>
<dd><p>Return a length <code class="docutils literal notranslate"><span class="pre">n</span></code> list of unique sequentially labelled strings for use as IDs.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_ids</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
<span class="go">[&#39;s00&#39;, s01&#39;, &#39;s02&#39;, &#39;s03&#39;, &#39;s04&#39;, &#39;s05&#39;, &#39;s06&#39;, &#39;s07&#39;, &#39;s08&#39;, &#39;s09&#39;, &#39;s10&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.replace_date">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">replace_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.replace_date" title="Link to this definition"></a></dt>
<dd><p>Given a table with a datetime object column called ‘datetime’ and given a
YYYYMMDD date string, replace the datetime dates with the given date
and return the resulting table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.seconds_to_timestr">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">seconds_to_timestr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod24</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">np.nan</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.seconds_to_timestr" title="Link to this definition"></a></dt>
<dd><p>The inverse of <a class="reference internal" href="#gtfs_kit.helpers.timestr_to_seconds" title="gtfs_kit.helpers.timestr_to_seconds"><code class="xref py py-func docutils literal notranslate"><span class="pre">timestr_to_seconds()</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">mod24</span></code>, then first take the number of seconds modulo <code class="docutils literal notranslate"><span class="pre">24*3600</span></code>.
Return NAN in case of bad inputs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.timestr_mod24">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">timestr_mod24</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">np.nan</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.timestr_mod24" title="Link to this definition"></a></dt>
<dd><p>Given a GTFS HH:MM:SS time string, return a timestring in the same
format but with the hours taken modulo 24.
Return NAN in case of bad inputes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.helpers.timestr_to_seconds">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.helpers.</span></span><span class="sig-name descname"><span class="pre">timestr_to_seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod24</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">np.nan</span></span></span><a class="headerlink" href="#gtfs_kit.helpers.timestr_to_seconds" title="Link to this definition"></a></dt>
<dd><p>Given an HH:MM:SS time string <code class="docutils literal notranslate"><span class="pre">x</span></code>, return the number of seconds
past midnight that it represents.
In keeping with GTFS standards, the hours entry may be greater than
23.
If <code class="docutils literal notranslate"><span class="pre">mod24</span></code>, then return the number of seconds modulo <code class="docutils literal notranslate"><span class="pre">24*3600</span></code>.
Return <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> in case of bad inputs.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.cleaners">
<span id="module-cleaners"></span><h2>Module cleaners<a class="headerlink" href="#module-gtfs_kit.cleaners" title="Link to this heading"></a></h2>
<p>Functions about cleaning feeds.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.aggregate_routes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">aggregate_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'route_short_name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_id_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'route_'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.aggregate_routes" title="Link to this definition"></a></dt>
<dd><p>Aggregate routes by route short name, say, and assign new route IDs using the
given prefix.</p>
<p>More specifically, create new route IDs with the function
<a class="reference internal" href="#gtfs_kit.cleaners.build_aggregate_routes_dict" title="gtfs_kit.cleaners.build_aggregate_routes_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_aggregate_routes_dict()</span></code></a> and the parameters <code class="docutils literal notranslate"><span class="pre">by</span></code> and
<code class="docutils literal notranslate"><span class="pre">route_id_prefix</span></code> and update the old route IDs to the new ones in all the relevant
Feed tables.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.aggregate_stops">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">aggregate_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stop_code'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_id_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stop_'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.aggregate_stops" title="Link to this definition"></a></dt>
<dd><p>Aggregate stops by stop code, say, and assign new stop IDs using the
given prefix.</p>
<p>More specifically, create new stop IDs with the function
<a class="reference internal" href="#gtfs_kit.cleaners.build_aggregate_stops_dict" title="gtfs_kit.cleaners.build_aggregate_stops_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_aggregate_stops_dict()</span></code></a> and the parameters <code class="docutils literal notranslate"><span class="pre">by</span></code> and
<code class="docutils literal notranslate"><span class="pre">stop_id_prefix</span></code> and update the old stop IDs to the new ones in all the relevant
Feed tables.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.build_aggregate_routes_dict">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">build_aggregate_routes_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">routes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'route_short_name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_id_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'route_'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.cleaners.build_aggregate_routes_dict" title="Link to this definition"></a></dt>
<dd><p>Given a DataFrame of routes, group the routes by route short name, say,
and assign new route IDs using the given prefix.
Return a dictionary of the form &lt;old route ID&gt; -&gt; &lt;new route ID&gt;.
Helper function for <a class="reference internal" href="#gtfs_kit.cleaners.aggregate_routes" title="gtfs_kit.cleaners.aggregate_routes"><code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate_routes()</span></code></a>.</p>
<p>More specifically, group <code class="docutils literal notranslate"><span class="pre">routes</span></code> by the <code class="docutils literal notranslate"><span class="pre">by</span></code> column, and for each group make
one new route ID for all the old route IDs in that group based on the given
<code class="docutils literal notranslate"><span class="pre">route_id_prefix</span></code> string and a running count, e.g. <code class="docutils literal notranslate"><span class="pre">'route_013'</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.build_aggregate_stops_dict">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">build_aggregate_stops_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stop_code'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_id_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stop_'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.cleaners.build_aggregate_stops_dict" title="Link to this definition"></a></dt>
<dd><p>Given a DataFrame of stops, group the stops by stop code, say,
and assign new stop IDs using the given prefix.
Return a dictionary of the form &lt;old stop ID&gt; -&gt; &lt;new stop ID&gt;.
Helper function for <a class="reference internal" href="#gtfs_kit.cleaners.aggregate_stops" title="gtfs_kit.cleaners.aggregate_stops"><code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate_stops()</span></code></a>.</p>
<p>More specifically, group <code class="docutils literal notranslate"><span class="pre">stops</span></code> by the <code class="docutils literal notranslate"><span class="pre">by</span></code> column, and for each group make
one new stop ID for all the old stops IDs in that group based on the given
<code class="docutils literal notranslate"><span class="pre">stop_id_prefix</span></code> string and a running count, e.g. <code class="docutils literal notranslate"><span class="pre">'stop_013'</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.clean">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.clean" title="Link to this definition"></a></dt>
<dd><p>Apply the following functions to the given Feed in order and return the resulting
Feed.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#gtfs_kit.cleaners.clean_ids" title="gtfs_kit.cleaners.clean_ids"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_ids()</span></code></a></p></li>
<li><p><a class="reference internal" href="#gtfs_kit.cleaners.clean_times" title="gtfs_kit.cleaners.clean_times"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_times()</span></code></a></p></li>
<li><p><a class="reference internal" href="#gtfs_kit.cleaners.clean_route_short_names" title="gtfs_kit.cleaners.clean_route_short_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_route_short_names()</span></code></a></p></li>
<li><p><a class="reference internal" href="#gtfs_kit.cleaners.drop_zombies" title="gtfs_kit.cleaners.drop_zombies"><code class="xref py py-func docutils literal notranslate"><span class="pre">drop_zombies()</span></code></a></p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.clean_column_names">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">clean_column_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.cleaners.clean_column_names" title="Link to this definition"></a></dt>
<dd><p>Strip the whitespace from all column names in the given DataFrame
and return the result.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.clean_ids">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">clean_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.clean_ids" title="Link to this definition"></a></dt>
<dd><p>In the given Feed, strip whitespace from all string IDs and
then replace every remaining whitespace chunk with an underscore.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.clean_route_short_names">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">clean_route_short_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.clean_route_short_names" title="Link to this definition"></a></dt>
<dd><p>In <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code>, assign ‘n/a’ to missing route short names and
strip whitespace from route short names.
Then disambiguate each route short name that is duplicated by
appending ‘-’ and its route ID.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.clean_times">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">clean_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.clean_times" title="Link to this definition"></a></dt>
<dd><p>In the given Feed, convert H:MM:SS time strings to HH:MM:SS time
strings to make sorting by time work as expected.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.drop_invalid_columns">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">drop_invalid_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.drop_invalid_columns" title="Link to this definition"></a></dt>
<dd><p>Drop all DataFrame columns of the given Feed that are not
listed in the GTFS.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.drop_zombies">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">drop_zombies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.drop_zombies" title="Link to this definition"></a></dt>
<dd><p>In the given Feed, do the following in order and return the resulting Feed.</p>
<ol class="arabic simple">
<li><p>Drop agencies with no routes.</p></li>
<li><p>Drop stops of location type 0 or NaN with no stop times.</p></li>
<li><p>Remove undefined parent stations from the <code class="docutils literal notranslate"><span class="pre">parent_station</span></code> column.</p></li>
<li><p>Drop trips with no stop times.</p></li>
<li><p>Drop shapes with no trips.</p></li>
<li><p>Drop routes with no trips.</p></li>
<li><p>Drop services with no trips.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.cleaners.extend_id">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.cleaners.</span></span><span class="sig-name descname"><span class="pre">extend_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.cleaners.extend_id" title="Link to this definition"></a></dt>
<dd><p>Add a prefix (if <code class="docutils literal notranslate"><span class="pre">prefix</span></code>) or a suffix (otherwise) to all values of column
<code class="docutils literal notranslate"><span class="pre">id_col</span></code> across all tables of this Feed.
This can be helpful when preparing to merge multiple GTFS feeds with colliding
route IDs, say.</p>
<p>Raises a ValueError if <code class="docutils literal notranslate"><span class="pre">id_col</span></code> values are strings,
e.g. if <code class="docutils literal notranslate"><span class="pre">id_col</span></code> is ‘direction_id’.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.calendar">
<span id="module-calendar"></span><h2>Module calendar<a class="headerlink" href="#module-gtfs_kit.calendar" title="Link to this heading"></a></h2>
<p>Functions about calendar and calendar_dates.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.calendar.get_dates">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.calendar.</span></span><span class="sig-name descname"><span class="pre">get_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_date_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.calendar.get_dates" title="Link to this definition"></a></dt>
<dd><p>Return a list of YYYYMMDD date strings for which the given Feed is valid,
which could be the empty list if the Feed has no calendar information.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_date_obj</span></code>, then return datetime.date objects instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.calendar.get_first_week">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.calendar.</span></span><span class="sig-name descname"><span class="pre">get_first_week</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_date_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.calendar.get_first_week" title="Link to this definition"></a></dt>
<dd><p>Return a list of YYYYMMDD date strings for the first Monday–Sunday
week (or initial segment thereof) for which the given Feed is valid.
If the feed has no Mondays, then return the empty list.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_date_obj</span></code>, then return date objects, otherwise return date strings.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.calendar.get_week">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.calendar.</span></span><span class="sig-name descname"><span class="pre">get_week</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_date_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.calendar.get_week" title="Link to this definition"></a></dt>
<dd><p>Given a Feed and a positive integer <code class="docutils literal notranslate"><span class="pre">k</span></code>,
return a list of YYYYMMDD date strings corresponding to the kth Monday–Sunday week
(or initial segment thereof) for which the Feed is valid.
For example, k=1 returns the first Monday–Sunday week (or initial segment thereof).
If the Feed does not have k Mondays, then return the empty list.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_date_obj</span></code>, then return datetime.date objects instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.calendar.subset_dates">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.calendar.</span></span><span class="sig-name descname"><span class="pre">subset_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.calendar.subset_dates" title="Link to this definition"></a></dt>
<dd><p>Given a Feed and a list of YYYYMMDD date strings,
return the sorted sublist of dates that lie in the Feed’s dates
(the output <code class="xref py py-func docutils literal notranslate"><span class="pre">feed.get_dates()</span></code>).
Could be an empty list.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.routes">
<span id="module-routes"></span><h2>Module routes<a class="headerlink" href="#module-gtfs_kit.routes" title="Link to this heading"></a></h2>
<p>Functions about routes.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.build_route_timetable">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">build_route_timetable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.routes.build_route_timetable" title="Link to this definition"></a></dt>
<dd><p>Return a timetable for the given route and dates (YYYYMMDD date strings).</p>
<p>Return a DataFrame with whose columns are all those in <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> plus those in
<code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> plus <code class="docutils literal notranslate"><span class="pre">'date'</span></code>.
The trip IDs are restricted to the given route ID.
The result is sorted first by date and then by grouping by
trip ID and sorting the groups by their first departure time.</p>
<p>Skip dates outside of the Feed’s dates.</p>
<p>If there is no route activity on the given dates, then return
an empty DataFrame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.compute_route_stats">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">compute_route_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'07:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'19:00:00'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.routes.compute_route_stats" title="Link to this definition"></a></dt>
<dd><p>Compute route stats for all the trips that lie in the given subset
of trip stats, which defaults to <code class="docutils literal notranslate"><span class="pre">feed.compute_trip_stats()</span></code>,
and that start on the given dates (YYYYMMDD date strings).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stats by trip direction (0 or 1).
Use the headway start and end times to specify the time period for computing
headway stats.</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: present if only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips on the route in the subset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips on the route with
nonnull start times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips on the route with nonnull
end times that end before 23:59:59</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stop_patterns'</span></code>: number of stop pattern across trips</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_loop'</span></code>: 1 if at least one of the trips on the route has
its <code class="docutils literal notranslate"><span class="pre">is_loop</span></code> field equal to 1; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_bidirectional'</span></code>: 1 if the route has trips in both
directions; 0 otherwise; present if only if not <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: start time of the earliest trip on the route</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: end time of latest trip on the route</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_headway'</span></code>: maximum of the durations (in minutes)
between trip starts on the route between
<code class="docutils literal notranslate"><span class="pre">headway_start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">headway_end_time</span></code> on the given
dates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_headway'</span></code>: minimum of the durations (in minutes)
mentioned above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_headway'</span></code>: mean of the durations (in minutes)
mentioned above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_num_trips'</span></code>: maximum number of simultaneous trips in
service (for the given direction, or for both directions when
<code class="docutils literal notranslate"><span class="pre">split_directions==False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_start_time'</span></code>: start time of first longest period
during which the peak number of trips occurs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_end_time'</span></code>: end time of first longest period during
which the peak number of trips occurs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: total of the duration of each trip on
the route in the given subset of trips; measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: total of the distance traveled by each
trip on the route in the given subset of trips;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: service_distance/service_duration when defined; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_trip_distance'</span></code>: service_distance/num_trips</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_trip_duration'</span></code>: service_duration/num_trips</p></li>
</ul>
<p>Exclude dates with no active trips, which could yield the empty DataFrame.</p>
<p>If not <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then compute each route’s stats,
except for headways, using its trips running in both directions.
For headways, (1) compute max headway by taking the max of the
max headways in both directions; (2) compute mean headway by
taking the weighted mean of the mean headways in both
directions.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
<li><p>The route stats for date d contain stats for trips that start on
date d only and ignore trips that start on date d-1 and end on
date d.</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.compute_route_stats_0">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">compute_route_stats_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'07:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'19:00:00'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.routes.compute_route_stats_0" title="Link to this definition"></a></dt>
<dd><p>Compute stats for the given subset of trips stats of the form output by the
function <a class="reference internal" href="#gtfs_kit.trips.compute_trip_stats" title="gtfs_kit.trips.compute_trip_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">trips.compute_trip_stats()</span></code></a>.
Ignore trips with zero duration.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stats by trip direction (0 or 1).
Use the headway start and end times to specify the time period for computing
headway stats.</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: present if only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips on the route in the subset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips on the route with
nonnull start times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips on the route with nonnull
end times that end before 23:59:59</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stop_patterns'</span></code>: number of stop pattern across trips</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_loop'</span></code>: 1 if at least one of the trips on the route has
its <code class="docutils literal notranslate"><span class="pre">is_loop</span></code> field equal to 1; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_bidirectional'</span></code>: 1 if the route has trips in both
directions; 0 otherwise; present if only if not <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: start time of the earliest trip on the route</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: end time of latest trip on the route</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_headway'</span></code>: maximum of the durations (in minutes)
between trip starts on the route between
<code class="docutils literal notranslate"><span class="pre">headway_start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">headway_end_time</span></code> on the given
dates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_headway'</span></code>: minimum of the durations (in minutes)
mentioned above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_headway'</span></code>: mean of the durations (in minutes)
mentioned above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_num_trips'</span></code>: maximum number of simultaneous trips in
service (for the given direction, or for both directions when
<code class="docutils literal notranslate"><span class="pre">split_directions==False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_start_time'</span></code>: start time of first longest period
during which the peak number of trips occurs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_end_time'</span></code>: end time of first longest period during
which the peak number of trips occurs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: total of the duration of each trip on
the route in the given subset of trips; measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: total of the distance traveled by each
trip on the route in the given subset of trips;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: service_distance/service_duration when defined; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_trip_distance'</span></code>: service_distance/num_trips</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_trip_duration'</span></code>: service_duration/num_trips</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">trip_stats</span></code> is empty, return an empty DataFrame.</p>
<p>If not <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then compute each route’s stats,
except for headways, using its trips running in both directions.
For headways, (1) compute max headway by taking the max of the
max headways in both directions; (2) compute mean headway by
taking the weighted mean of the mean headways in both
directions.</p>
<p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.compute_route_time_series">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">compute_route_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.routes.compute_route_time_series" title="Link to this definition"></a></dt>
<dd><p>Compute route stats in time series form for the trips that lie in
the trip stats subset, which defaults to the output of
<a class="reference internal" href="#gtfs_kit.trips.compute_trip_stats" title="gtfs_kit.trips.compute_trip_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">trips.compute_trip_stats()</span></code></a>, and that start on the given dates
(YYYYMMDD date strings).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate each routes’s stats by trip direction.
Specify the time series frequency with a Pandas frequency string, e.g. <code class="docutils literal notranslate"><span class="pre">'5Min'</span></code>.</p>
<p>Return a time series DataFrame with the following columns.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: datetime object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">route_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction_id</span></code>: direction of route; presest if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trips</span></code>: number of trips in service on the route
at any time within the time bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trip_starts</span></code>: number of trips that start within
the time bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trip_ends</span></code>: number of trips that end within the
time bin, ignoring trips that end past midnight</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_distance</span></code>: sum of the service distance accrued
during the time bin across all trips on the route;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_duration</span></code>: sum of the service duration accrued
during the time bin across all trips on the route;
measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_speed</span></code>: <code class="docutils literal notranslate"><span class="pre">service_distance/service_duration</span></code>
for the route</p></li>
</ul>
<p>Exclude dates that lie outside of the Feed’s date range.
If all dates lie outside the Feed’s date range, then return an
empty DataFrame.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
<li><p>See the notes for <a class="reference internal" href="#gtfs_kit.routes.compute_route_time_series_0" title="gtfs_kit.routes.compute_route_time_series_0"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_route_time_series_0()</span></code></a></p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.compute_route_time_series_0">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">compute_route_time_series_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'20010101'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.routes.compute_route_time_series_0" title="Link to this definition"></a></dt>
<dd><p>Compute stats in a 24-hour time series form at the given Pandas frequency
for the given subset of trip stats of the
form output by the function <a class="reference internal" href="#gtfs_kit.trips.compute_trip_stats" title="gtfs_kit.trips.compute_trip_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">trips.compute_trip_stats()</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate each routes’s stats by trip direction.
Use the given YYYYMMDD date label as the date in the time series index.</p>
<p>Return a long-format DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: datetime object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">route_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction_id</span></code>: direction of route; presest if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trips</span></code>: number of trips in service on the route
at any time within the time bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trip_starts</span></code>: number of trips that start within
the time bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trip_ends</span></code>: number of trips that end within the
time bin, ignoring trips that end past midnight</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_distance</span></code>: sum of the service distance accrued
during the time bin across all trips on the route;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_duration</span></code>: sum of the service duration accrued
during the time bin across all trips on the route;
measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_speed</span></code>: <code class="docutils literal notranslate"><span class="pre">service_distance/service_duration</span></code>
for the route</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Trips that lack start or end times are ignored, so the the
aggregate <code class="docutils literal notranslate"><span class="pre">num_trips</span></code> across the day could be less than the
<code class="docutils literal notranslate"><span class="pre">num_trips</span></code> column of <a class="reference internal" href="#gtfs_kit.routes.compute_route_stats_0" title="gtfs_kit.routes.compute_route_stats_0"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_route_stats_0()</span></code></a></p></li>
<li><p>All trip departure times are taken modulo 24 hours.
So routes with trips that end past 23:59:59 will have all
their stats wrap around to the early morning of the time series,
except for their <code class="docutils literal notranslate"><span class="pre">num_trip_ends</span></code> indicator.
Trip endings past 23:59:59 are not binned so that resampling the
<code class="docutils literal notranslate"><span class="pre">num_trips</span></code> indicator works efficiently.</p></li>
<li><p>Note that the total number of trips for two consecutive time bins
t1 &lt; t2 is the sum of the number of trips in bin t2 plus the
number of trip endings in bin t1.
Thus we can downsample the <code class="docutils literal notranslate"><span class="pre">num_trips</span></code> indicator by keeping
track of only one extra count, <code class="docutils literal notranslate"><span class="pre">num_trip_ends</span></code>, and can avoid
recording individual trip IDs.</p></li>
<li><p>All other indicators are downsampled by summing.</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.get_routes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">get_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.routes.get_routes" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code> or a subset thereof.
If a YYYYMMDD date string is given, then restrict routes to only those active on
the date.
If a HH:MM:SS time string is given, possibly with HH &gt; 23, then restrict routes
to only those active during the time.</p>
<p>Given a Feed, return a GeoDataFrame with all the columns of <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code>
plus a geometry column of (Multi)LineStrings, each of which represents the
corresponding routes’s shape.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then return a GeoDataFrame with all the columns of <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code>
plus a geometry column of (Multi)LineStrings, each of which represents the
corresponding routes’s union of trip shapes.
The GeoDataFrame will have a local UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>; otherwise it will have
CRS WGS84.
If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then add the column <code class="docutils literal notranslate"><span class="pre">direction_id</span></code> and
split each route into the union of its direction 0 shapes
and the union of its direction 1 shapes.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then raise a ValueError.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.map_routes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">map_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_short_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_palette</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['#66c2a5',</span> <span class="pre">'#fc8d62',</span> <span class="pre">'#8da0cb',</span> <span class="pre">'#e78ac3',</span> <span class="pre">'#a6d854',</span> <span class="pre">'#ffd92f',</span> <span class="pre">'#e5c494',</span> <span class="pre">'#b3b3b3']</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.routes.map_routes" title="Link to this definition"></a></dt>
<dd><p>Return a Folium map showing the given routes and (optionally) their stops.
At least one of <code class="docutils literal notranslate"><span class="pre">route_ids</span></code> and <code class="docutils literal notranslate"><span class="pre">route_short_names</span></code> must be given.
If both are given, then combine the two into a single set of routes.
If any of the given route IDs are not found in the feed, then raise a ValueError.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.routes.routes_to_geojson">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.routes.</span></span><span class="sig-name descname"><span class="pre">routes_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_short_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.routes.routes_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection (in WGS84 coordinates) of MultiLineString
features representing this Feed’s routes.</p>
<p>If an iterable of route IDs or route short names is given, then subset to the
union of those routes, which could yield an empty FeatureCollection in case of
all invalid route IDs / route short names.
If <code class="docutils literal notranslate"><span class="pre">include_stops</span></code>, then include the route stops as Point features.
If the Feed has no shapes, then raise a ValueError.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.shapes">
<span id="module-shapes"></span><h2>Module shapes<a class="headerlink" href="#module-gtfs_kit.shapes" title="Link to this heading"></a></h2>
<p>Functions about shapes.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.append_dist_to_shapes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">append_dist_to_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.shapes.append_dist_to_shapes" title="Link to this definition"></a></dt>
<dd><p>Calculate and append the optional <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> field in
<code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> in terms of the distance units <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code>.
Return the resulting Feed.</p>
<p>As a benchmark, using this function on <a class="reference external" href="https://transitfeeds.com/p/trimet/43/1400947517">this Portland feed</a>
produces a <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column that differs by at most
0.016 km in absolute value from of the original values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.build_geometry_by_shape">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">build_geometry_by_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.build_geometry_by_shape" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary of the form
&lt;shape ID&gt; -&gt; &lt;Shapely LineString representing shape&gt;.
If the Feed has no shapes, then return the empty dictionary.
If <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>, then use local UTM coordinates; otherwise, use WGS84 coordinates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.geometrize_shapes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">geometrize_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.geometrize_shapes" title="Link to this definition"></a></dt>
<dd><p>Given a GTFS shapes DataFrame, convert it to a GeoDataFrame of LineStrings
and return the result, which will no longer have the columns
<code class="docutils literal notranslate"><span class="pre">'shape_pt_sequence'</span></code>, <code class="docutils literal notranslate"><span class="pre">'shape_pt_lon'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'shape_pt_lat'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'shape_dist_traveled'</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>, then use local UTM coordinates for the geometries.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.get_shapes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">get_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">gpd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.get_shapes" title="Link to this definition"></a></dt>
<dd><p>Get the shapes DataFrame for the given feed, which could be <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then return it as GeoDataFrame with a ‘geometry’ column
of linestrings and no ‘shape_pt_sequence’, ‘shape_pt_lon’, ‘shape_pt_lat’,
‘shape_dist_traveled’ columns.
The GeoDataFrame will have a UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>; otherwise it will have a
WGS84 CRS.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.get_shapes_intersecting_geometry">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">get_shapes_intersecting_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sg.base.BaseGeometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.get_shapes_intersecting_geometry" title="Link to this definition"></a></dt>
<dd><p>If the Feed has no shapes, then return None.
Otherwise, return the subset of <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> that contains all shapes that
intersect the given Shapely WGS84 geometry, e.g. a Polygon or LineString.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then return the shapes as a GeoDataFrame.
Specifying <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> will skip the first step of the
algorithm, namely, geometrizing <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.shapes_to_geojson">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">shapes_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.shapes_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection of LineString features
representing <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code>.
If the Feed has no shapes, then the features will be an empty list.
The coordinates reference system is the default one for GeoJSON,
namely WGS84.</p>
<p>If an iterable of shape IDs is given, then subset to those shapes.
If the subset is empty, then return a FeatureCollection with an empty list of
features.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.split_simple">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">split_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapes_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.split_simple" title="Link to this definition"></a></dt>
<dd><p>Given a GeoDataFrame of GTFS shapes of the form output by <a class="reference internal" href="#gtfs_kit.shapes.geometrize_shapes" title="gtfs_kit.shapes.geometrize_shapes"><code class="xref py py-func docutils literal notranslate"><span class="pre">geometrize_shapes()</span></code></a>
with possibly non-WGS84 coordinates,
split each non-simple LineString into large simple (non-self-intersecting)
sub-LineStrings, and leave the simple LineStrings as is.</p>
<p>Return a GeoDataFrame in the coordinates of <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code>: GTFS shape ID for a LineString L</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_id'</span></code>: a unique identifier of a simple sub-LineString S of L</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_sequence'</span></code>: integer; indicates the order of S when joining up
all simple sub-LineStrings to form L</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_length_m'</span></code>: the length of S in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cum_length_m'</span></code>: the length S plus the lengths of sub-LineStrings of L
that come before S; in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'geometry'</span></code>: LineString geometry corresponding to S</p></li>
</ul>
<p>Within each ‘shape_id’ group, the subshapes will be sorted increasingly by
‘subshape_sequence’.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>Simplicity checks and splitting are done in local UTM coordinates.
Converting back to original coordinates can introduce rounding errors and
non-simplicities.
So test this function with a <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> in local UTM coordinates.</p></li>
<li><p>By construction, for each given LineString L with simple sub-LineStrings
S_i, we have the inequality</p>
<blockquote>
<div><p>sum over i of length(S_i) &lt;= length(L),</p>
</div></blockquote>
<p>where the lengths are expressed in meters.</p>
</li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.split_simple_0">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">split_simple_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LineString</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">LineString</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.shapes.split_simple_0" title="Link to this definition"></a></dt>
<dd><p>Split the given LineString into simple sub-LineStrings by greedily building
the segments from the LineString points and binary search,
checking for simplicity at every step.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.shapes.ungeometrize_shapes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.shapes.</span></span><span class="sig-name descname"><span class="pre">ungeometrize_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapes_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.shapes.ungeometrize_shapes" title="Link to this definition"></a></dt>
<dd><p>The inverse of <a class="reference internal" href="#gtfs_kit.shapes.geometrize_shapes" title="gtfs_kit.shapes.geometrize_shapes"><code class="xref py py-func docutils literal notranslate"><span class="pre">geometrize_shapes()</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> is in UTM coordinates (has a UTM CRS property),
then convert those UTM coordinates back to WGS84 coordinates,
which is the standard for a GTFS shapes table.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.stop_times">
<span id="module-stop-times"></span><h2>Module stop_times<a class="headerlink" href="#module-gtfs_kit.stop_times" title="Link to this heading"></a></h2>
<p>Functions about stop times.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stop_times.append_dist_to_stop_times">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stop_times.</span></span><span class="sig-name descname"><span class="pre">append_dist_to_stop_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.stop_times.append_dist_to_stop_times" title="Link to this definition"></a></dt>
<dd><p>Calculate and append the optional <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column in
<code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> in terms of the distance units <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code>.
Trips without shapes will have NaN distances.
Return the resulting Feed.
Uses <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code>, so if that is missing, then return the original feed.</p>
<p>This does not always give accurate results.
The algorithm works as follows.
Compute the <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> field by using Shapely to
measure the distance of a stop along its trip LineString.
If for a given trip this process produces a non-monotonically
increasing, hence incorrect, list of (cumulative) distances, then
fall back to estimating the distances as follows.</p>
<p>Set the first distance to 0, the last to the length of the trip shape,
and leave the remaining ones computed above.
Choose the longest increasing subsequence of that new set of
distances and use them and their corresponding departure times to linearly
interpolate the rest of the distances.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stop_times.get_start_and_end_times">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stop_times.</span></span><span class="sig-name descname"><span class="pre">get_start_and_end_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.stop_times.get_start_and_end_times" title="Link to this definition"></a></dt>
<dd><p>Return the first departure time and last arrival time
(HH:MM:SS time strings) listed in <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code>, respectively.
Restrict to the given date (YYYYMMDD string) if specified.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stop_times.get_stop_times">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stop_times.</span></span><span class="sig-name descname"><span class="pre">get_stop_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stop_times.get_stop_times" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code>.
If a date (YYYYMMDD date string) is given, then subset the result to only those
stop times with trips active on the date.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stop_times.stop_times_to_geojson">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stop_times.</span></span><span class="sig-name descname"><span class="pre">stop_times_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.stop_times.stop_times_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection (in WGS84 coordinates) of Point features
representing all the trip-stop pairs in <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code>.</p>
<p>For every trip, drop duplicate stop IDs within that trip.
In particular, a looping trip will lack its final stop.</p>
<p>If an iterable of trip IDs is given, then subset to those trips, which could yield
an empty FeatureCollection in case of all invalid trips.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.stops">
<span id="module-stops"></span><h2>Module stops<a class="headerlink" href="#module-gtfs_kit.stops" title="Link to this heading"></a></h2>
<p>Functions about stops.</p>
<dl class="py data">
<dt class="sig sig-object py" id="gtfs_kit.stops.STOP_STYLE">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">STOP_STYLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'color':</span> <span class="pre">'#fc8d62',</span> <span class="pre">'fill':</span> <span class="pre">'true',</span> <span class="pre">'fillOpacity':</span> <span class="pre">0.75,</span> <span class="pre">'radius':</span> <span class="pre">8,</span> <span class="pre">'weight':</span> <span class="pre">1}</span></em><a class="headerlink" href="#gtfs_kit.stops.STOP_STYLE" title="Link to this definition"></a></dt>
<dd><p>Leaflet circleMarker parameters for mapping stops</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.build_geometry_by_stop">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">build_geometry_by_stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.stops.build_geometry_by_stop" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary of the form &lt;stop ID&gt; -&gt; &lt;Shapely Point representing stop&gt;.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.build_stop_timetable">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">build_stop_timetable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.build_stop_timetable" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame containing the timetable for the given stop ID
and dates (YYYYMMDD date strings)</p>
<p>Return a DataFrame whose columns are all those in <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> plus those in
<code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> plus <code class="docutils literal notranslate"><span class="pre">'date'</span></code>, and the stop IDs are restricted to the given
stop ID.
The result is sorted by date then departure time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.compute_stop_activity">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">compute_stop_activity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.compute_stop_activity" title="Link to this definition"></a></dt>
<dd><p>Mark stops as active or inactive on the given dates (YYYYMMDD date strings).
A stop is <em>active</em> on a given date if some trips that starts on the
date visits the stop (possibly after midnight).</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p>stop_id</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>: 1 if the stop has at least one trip visiting it
on <code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>: 1 if the stop has at least one trip visiting it
on <code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>; 0 otherwise</p></li>
<li><p>etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>: 1 if the stop has at least one trip visiting it
on <code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>; 0 otherwise</p></li>
</ul>
<p>If all dates lie outside the Feed period, then return an empty DataFrame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.compute_stop_stats">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">compute_stop_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'07:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'19:00:00'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.compute_stop_stats" title="Link to this definition"></a></dt>
<dd><p>Compute stats for all stops for the given dates (YYYYMMDD date strings).
Optionally, restrict to the stop IDs given.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stop stats by direction (0 or 1)
of the trips visiting the stops.
Use the headway start and end times to specify the time period for computing
headway stats.</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'stop_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: present if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_routes'</span></code>: number of routes visiting the stop
(in the given direction) on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips visiting stop
(in the givin direction) on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_headway'</span></code>: maximum of the durations (in minutes)
between trip departures at the stop between
<code class="docutils literal notranslate"><span class="pre">headway_start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">headway_end_time</span></code> on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_headway'</span></code>: minimum of the durations (in minutes) mentioned
above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_headway'</span></code>: mean of the durations (in minutes) mentioned
above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: earliest departure time of a trip from this stop
on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: latest departure time of a trip from this stop on
the date</p></li>
</ul>
<p>Exclude dates with no active stops, which could yield the empty DataFrame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.compute_stop_stats_0">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">compute_stop_stats_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_times_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trips_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'07:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'19:00:00'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.compute_stop_stats_0" title="Link to this definition"></a></dt>
<dd><p>Given a subset of a trips DataFrame and a subset of a stop times
DataFrame, return a DataFrame that provides summary stats about the
stops in the inner join of the two DataFrames.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stop stats by direction (0 or 1)
of the trips visiting the stops.
Use the headway start and end times to specify the time period for computing
headway stats.</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p>stop_id</p></li>
<li><p>direction_id: present if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p>num_routes: number of routes visiting stop
(in the given direction)</p></li>
<li><p>num_trips: number of trips visiting stop
(in the givin direction)</p></li>
<li><p>max_headway: maximum of the durations (in minutes)
between trip departures at the stop between
<code class="docutils literal notranslate"><span class="pre">headway_start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">headway_end_time</span></code></p></li>
<li><p>min_headway: minimum of the durations (in minutes) mentioned
above</p></li>
<li><p>mean_headway: mean of the durations (in minutes) mentioned
above</p></li>
<li><p>start_time: earliest departure time of a trip from this stop</p></li>
<li><p>end_time: latest departure time of a trip from this stop</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">trips_subset</span></code> is empty, then return an empty DataFrame.</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-NaN
direction ID values present.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.compute_stop_time_series">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">compute_stop_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.compute_stop_time_series" title="Link to this definition"></a></dt>
<dd><p>Compute time series for the given stops (defaults to all stops in Feed)
on the given dates (YYYYMMDD date strings) at the
given frequency (Pandas frequency string, e.g. <code class="docutils literal notranslate"><span class="pre">'5Min'</span></code>).
Return a long-format DataFrame with columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: datetime object for the given date and frequency chunks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction_id</span></code>: direction of route; presest if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trips</span></code>: the number of trips that visit the stop in the time bin and
have a nonnull departure time from the stop</p></li>
</ul>
<p>Exclude dates that lie outside of the Feed’s date range.
If all dates lie outside the Feed’s date range, then return an
empty DataFrame</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stop stats by direction (0 or 1)
of the trips visiting the stops.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The time series is computed at a one-minute frequency, then
resampled at the end to the given frequency</p></li>
<li><p>Stop times with null departure times are ignored, so the aggregate
of <code class="docutils literal notranslate"><span class="pre">num_trips</span></code> across the day could be less than the
<code class="docutils literal notranslate"><span class="pre">num_trips</span></code> column in <a class="reference internal" href="#gtfs_kit.stops.compute_stop_stats_0" title="gtfs_kit.stops.compute_stop_stats_0"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stop_stats_0()</span></code></a></p></li>
<li><p>All trip departure times are taken modulo 24 hours,
so routes with trips that end past 23:59:59 will have all
their stats wrap around to the early morning of the time series.</p></li>
<li><p>‘num_trips’ should be resampled with <code class="docutils literal notranslate"><span class="pre">how=np.sum</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">trips_subset</span></code> is empty, then return an empty DataFrame</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.compute_stop_time_series_0">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">compute_stop_time_series_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_times_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trips_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'20010101'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.compute_stop_time_series_0" title="Link to this definition"></a></dt>
<dd><p>Compute stop stats in a 24-hour time series form at the given Pandas frequency
for stops in the inner join of the given subset of stop times and trips.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate each stop’s stats by trip direction.
Use the given YYYYMMDD date label as the date in the time series index.</p>
<p>Return a long-format DataFrame with columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: datetime object for the given date and frequency chunks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction_id</span></code>: direction of route; presest if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trips</span></code>: the number of trips that visit the stop in the time bin and
have a nonnull departure time from the stop</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The time series is computed at a one-minute frequency, then
resampled at the end to the given frequency</p></li>
<li><p>Stop times with null departure times are ignored, so the aggregate
of <code class="docutils literal notranslate"><span class="pre">num_trips</span></code> across the day could be less than the
<code class="docutils literal notranslate"><span class="pre">num_trips</span></code> column in <a class="reference internal" href="#gtfs_kit.stops.compute_stop_stats_0" title="gtfs_kit.stops.compute_stop_stats_0"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stop_stats_0()</span></code></a></p></li>
<li><p>All trip departure times are taken modulo 24 hours,
so routes with trips that end past 23:59:59 will have all
their stats wrap around to the early morning of the time series.</p></li>
<li><p>‘num_trips’ should be resampled with <code class="docutils literal notranslate"><span class="pre">how=np.sum</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">trips_subset</span></code> is empty, then return an empty DataFrame</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.geometrize_stops">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">geometrize_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.geometrize_stops" title="Link to this definition"></a></dt>
<dd><p>Given a stops DataFrame, convert it to a GeoPandas GeoDataFrame of Points
and return the result, which will no longer have the columns <code class="docutils literal notranslate"><span class="pre">'stop_lon'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'stop_lat'</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.get_stops">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">get_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_stations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.get_stops" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.stops</span></code>.
If a YYYYMMDD date string is given, then subset to stops
active (visited by trips) on that date.
If trip IDs are given, then subset further to stops visited by those
trips.
If route IDs are given, then ignore the trip IDs and subset further
to stops visited by those routes.
If <code class="docutils literal notranslate"><span class="pre">in_stations</span></code>, then subset further stops in stations if station data
is available.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then return the result as a GeoDataFrame with a ‘geometry’
column of points instead of ‘stop_lat’ and ‘stop_lon’ columns.
The GeoDataFrame will have a UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code> and a WGS84 CRS otherwise.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.get_stops_in_area">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">get_stops_in_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.get_stops_in_area" title="Link to this definition"></a></dt>
<dd><p>Return the subset of <code class="docutils literal notranslate"><span class="pre">feed.stops</span></code> that contains all stops that lie
within the given GeoDataFrame of polygons.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.map_stops">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">map_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">'#fc8d62',</span> <span class="pre">'fill':</span> <span class="pre">'true',</span> <span class="pre">'fillOpacity':</span> <span class="pre">0.75,</span> <span class="pre">'radius':</span> <span class="pre">8,</span> <span class="pre">'weight':</span> <span class="pre">1}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.stops.map_stops" title="Link to this definition"></a></dt>
<dd><p>Return a Folium map showing the given stops of this Feed.
If some of the given stop IDs are not found in the feed, then raise a ValueError.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.stops_to_geojson">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">stops_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.stops.stops_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection of Point features
representing all the stops in <code class="docutils literal notranslate"><span class="pre">feed.stops</span></code>.
The coordinates reference system is the default one for GeoJSON,
namely WGS84.</p>
<p>If an iterable of stop IDs is given, then subset to those stops.
If some of the given stop IDs are not found in the feed, then raise a ValueError.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.stops.ungeometrize_stops">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.stops.</span></span><span class="sig-name descname"><span class="pre">ungeometrize_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stops_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.stops.ungeometrize_stops" title="Link to this definition"></a></dt>
<dd><p>The inverse of <a class="reference internal" href="#gtfs_kit.stops.geometrize_stops" title="gtfs_kit.stops.geometrize_stops"><code class="xref py py-func docutils literal notranslate"><span class="pre">geometrize_stops()</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">stops_g</span></code> is in UTM coordinates (has a UTM CRS property),
then convert those UTM coordinates back to WGS84 coordinates,
which is the standard for a GTFS shapes table.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.trips">
<span id="module-trips"></span><h2>Module trips<a class="headerlink" href="#module-gtfs_kit.trips" title="Link to this heading"></a></h2>
<p>Functions about trips.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.compute_busiest_date">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">compute_busiest_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#gtfs_kit.trips.compute_busiest_date" title="Link to this definition"></a></dt>
<dd><p>Given a list of dates (YYYYMMDD date strings), return the first date that has the
maximum number of active trips.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.compute_trip_activity">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">compute_trip_activity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.trips.compute_trip_activity" title="Link to this definition"></a></dt>
<dd><p>Mark trips as active or inactive on the given dates (YYYYMMDD date strings).
Return a table with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>: 1 if the trip is active on <code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>;
0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>: 1 if the trip is active on <code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>;
0 otherwise</p></li>
<li><p>etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>: 1 if the trip is active on <code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>;
0 otherwise</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">dates</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> or the empty list, then return an
empty DataFrame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.compute_trip_stats">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">compute_trip_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_dist_from_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.trips.compute_trip_stats" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame with the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: NaN if missing from feed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code>: NaN if missing from feed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'stop_pattern_name'</span></code>: output from <a class="reference internal" href="#gtfs_kit.trips.name_stop_patterns" title="gtfs_kit.trips.name_stop_patterns"><code class="xref py py-func docutils literal notranslate"><span class="pre">name_stop_patterns()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stops'</span></code>: number of stops on trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: first departure time of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: last departure time of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_stop_id'</span></code>: stop ID of the first stop of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_stop_id'</span></code>: stop ID of the last stop of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_loop'</span></code>: 1 if the start and end stop are less than 400m apart and
0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'distance'</span></code>: distance of the trip;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'duration'</span></code>: duration of the trip in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'speed'</span></code>: distance/duration</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> has a <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column with at
least one non-NaN value and <code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes</span> <span class="pre">==</span> <span class="pre">False</span></code>,
then use that column to compute the distance column.
Else if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>, then compute the distance
column using the shapes and Shapely.
Otherwise, set the distances to NaN.</p>
<p>If route IDs are given, then restrict to trips on those routes.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>Assume the following feed attributes are not <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">feed.trips</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed.routes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> (optionally)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Calculating trip distances with <code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes=True</span></code>
seems pretty accurate.  For example, calculating trip distances on
<a class="reference external" href="https://transitfeeds.com/p/trimet/43/1400947517">this Portland feed</a>
using <code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes=False</span></code> and
<code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes=True</span></code>,
yields a difference of at most 0.83km from the original values.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.get_active_services">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">get_active_services</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.trips.get_active_services" title="Link to this definition"></a></dt>
<dd><p>Given a Feed and a date string in YYYYMMDD format,
return the list of service IDs that are active on the date.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.get_trips">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">get_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.trips.get_trips" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code>.
If date (YYYYMMDD date string) is given then subset the result to trips
that start on that date.
If a time (HH:MM:SS string, possibly with HH &gt; 23) is given in addition to a date,
then further subset the result to trips in service at that time.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is not None, then return the trips as a
GeoDataFrame of LineStrings representating trip shapes.
Use local UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>; otherwise it the WGS84 CRS.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then raise a ValueError.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.locate_trips">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">locate_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.trips.locate_trips" title="Link to this definition"></a></dt>
<dd><p>Return the positions of all trips active on the
given date (YYYYMMDD date string) and times (HH:MM:SS time strings,
possibly with HH &gt; 23).</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: all NaNs if <code class="docutils literal notranslate"><span class="pre">feed.trips.direction_id</span></code> is
missing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'time'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rel_dist'</span></code>: number between 0 (start) and 1 (end)
indicating the relative distance of the trip along its path</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lon'</span></code>: longitude of trip at given time</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lat'</span></code>: latitude of trip at given time</p></li>
</ul>
<p>Assume <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> has an accurate
<code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.map_trips">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">map_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_palette</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['#66c2a5',</span> <span class="pre">'#fc8d62',</span> <span class="pre">'#8da0cb',</span> <span class="pre">'#e78ac3',</span> <span class="pre">'#a6d854',</span> <span class="pre">'#ffd92f',</span> <span class="pre">'#e5c494',</span> <span class="pre">'#b3b3b3']</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.trips.map_trips" title="Link to this definition"></a></dt>
<dd><p>Return a Folium map showing the given trips and (optionally)
their stops.
If any of the given trip IDs are not found in the feed, then raise a ValueError.
If <code class="docutils literal notranslate"><span class="pre">include_direction</span></code>, then use the Folium plugin PolyLineTextPath to draw arrows
on each trip polyline indicating its direction of travel; this fails to work in some
browsers, such as Brave 0.68.132.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.name_stop_patterns">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">name_stop_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.trips.name_stop_patterns" title="Link to this definition"></a></dt>
<dd><p>For each (route ID, direction ID) pair, find the distinct stop patterns of its
trips, and assign them each an integer <em>pattern rank</em> based on the stop pattern’s
frequency rank, where 1 is the most frequent stop pattern, 2 is the second most
frequent, etc.
Return the DataFrame <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> with the additional column
<code class="docutils literal notranslate"><span class="pre">stop_pattern_name</span></code>, which equals the trip’s ‘direction_id’ concatenated with a
dash and its stop pattern rank.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> has no ‘direction_id’ column, then temporarily create one equal
to all zeros, proceed as above, then delete the column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.trips.trips_to_geojson">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.trips.</span></span><span class="sig-name descname"><span class="pre">trips_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.trips.trips_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection (in WGS84 coordinates) of LineString features
representing this Feed’s trips.</p>
<p>If an iterable of trip IDs is given, then subset to those trips, which could yield
an empty FeatureCollection in case all trip IDs are invalid.
If <code class="docutils literal notranslate"><span class="pre">include_stops</span></code>, then include the trip stops as Point features.
If the Feed has no shapes, then raise a ValueError.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.miscellany">
<span id="module-miscellany"></span><h2>Module miscellany<a class="headerlink" href="#module-gtfs_kit.miscellany" title="Link to this heading"></a></h2>
<p>Functions about miscellany.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.assess_quality">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">assess_quality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.assess_quality" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame of various feed indicators and values,
e.g. number of trips missing shapes.</p>
<p>The resulting DataFrame has the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'indicator'</span></code>: string; name of an indicator, e.g. ‘num_routes’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'value'</span></code>: value of the indicator, e.g. 27</p></li>
</ul>
<p>This function is odd but useful for seeing roughly how broken a feed is
This function is not a GTFS validator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_bounds">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">np.array</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_bounds" title="Link to this definition"></a></dt>
<dd><p>Return the bounding box (Numpy array [min longitude, min latitude, max longitude,
max latitude]) of the given Feed’s stops or of the subset of stops
specified by the given stop IDs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_centroid">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">sg.Point</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_centroid" title="Link to this definition"></a></dt>
<dd><p>Return the centroid (Shapely Point) of the convex hull the given Feed’s stops
or of the subset of stops specified by the given stop IDs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_convex_hull">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_convex_hull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">sg.Polygon</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_convex_hull" title="Link to this definition"></a></dt>
<dd><p>Return a convex hull (Shapely Polygon) representing the convex hull of the given
Feed’s stops or of the subset of stops specified by the given stop IDs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_network_stats">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_network_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_route_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_network_stats" title="Link to this definition"></a></dt>
<dd><p>Compute some network stats for the given subset of trip stats, which defaults to
<cite>feed.compute_trip_stats()</cite>, and for the given dates (YYYYMMDD date stings).</p>
<p>Return a table with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code> (optional): presest if and only if <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stops'</span></code>: number of stops active on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_routes'</span></code>: number of routes active on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips that start on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips with nonnull start
times on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips with nonnull start times
and nonnull end times on the date, ignoring trips that end
after 23:59:59 on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_num_trips'</span></code>: maximum number of simultaneous trips in
service on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_start_time'</span></code>: start time of first longest period
during which the peak number of trips occurs on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_end_time'</span></code>: end time of first longest period during
which the peak number of trips occurs on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: sum of the service distances for the
active routes on the date;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: sum of the service durations for the
active routes on the date; measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: service_distance/service_duration on the
date</p></li>
</ul>
<p>Exclude dates with no active stops, which could yield the empty DataFrame.</p>
<p>The route and trip stats for date d contain stats for trips that
start on date d only and ignore trips that start on date d-1 and
end on date d.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_network_stats_0">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_network_stats_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_times_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_route_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_network_stats_0" title="Link to this definition"></a></dt>
<dd><p>Compute some network stats for the trips common to the
given subset of stop times and given subses of trip stats
of the form output by the function <a class="reference internal" href="#gtfs_kit.trips.compute_trip_stats" title="gtfs_kit.trips.compute_trip_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">trips.compute_trip_stats()</span></code></a></p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code> (optional): presest if and only if <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stops'</span></code>: number of stops active on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_routes'</span></code>: number of routes active on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips that start on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips with nonnull start
times on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips with nonnull start times
and nonnull end times on the date, ignoring trips that end
after 23:59:59 on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_num_trips'</span></code>: maximum number of simultaneous trips in
service on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_start_time'</span></code>: start time of first longest period
during which the peak number of trips occurs on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_end_time'</span></code>: end time of first longest period during
which the peak number of trips occurs on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: sum of the service distances for the
active routes on the date;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: sum of the service durations for the
active routes on the date; measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: service_distance/service_duration on the
date</p></li>
</ul>
<p>Exclude dates with no active stops, which could yield the empty DataFrame.</p>
<p>Helper function for <a class="reference internal" href="#gtfs_kit.miscellany.compute_network_stats" title="gtfs_kit.miscellany.compute_network_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_network_stats()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_network_time_series">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_network_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_route_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_network_time_series" title="Link to this definition"></a></dt>
<dd><p>Compute some network stats in time series form for the given dates
(YYYYMMDD date strings) and trip stats, which defaults to
<code class="docutils literal notranslate"><span class="pre">feed.compute_trip_stats()</span></code>.
Use the given Pandas frequency string <code class="docutils literal notranslate"><span class="pre">freq</span></code> to specify the frequency of the
resulting time series, e.g. ‘5Min’.
If <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code>, then split stats by route type; otherwise don’t.</p>
<p>Return a long-form time series table with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'datetime'</span></code>: datetime object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code>: integer; present if and only if <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips in service during during the
time period</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips with starting during the
time period</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips ending during the
time period, ignoring the trips the end past midnight</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: distance traveled during the time
period by all trips active during the time period;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: duration traveled during the time
period by all trips active during the time period;
measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: <code class="docutils literal notranslate"><span class="pre">service_distance/service_duration</span></code> when defined; 0
otherwise</p></li>
</ul>
<p>Exclude dates that lie outside of the Feed’s date range.
If all the dates given lie outside of the Feed’s date range,
then return an empty DataFrame with the specified columns.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.compute_screen_line_counts">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">compute_screen_line_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_testing_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.compute_screen_line_counts" title="Link to this definition"></a></dt>
<dd><p>Find all the Feed trips active on the given YYYYMMDD dates that intersect
the given segment-associated screen lines of the form output by
<code class="xref py py-func docutils literal notranslate"><span class="pre">build_screen_lines()</span></code>.
Behind the scenes, use simple sub-LineStrings of the feed
to compute screen line intersections.
Using them instead of the Feed shapes avoids miscounting intersections in the
case of non-simple (self-intersecting) shapes.</p>
<p>For each trip crossing a screen line,
compute the crossing time, crossing direction, etc. and return a DataFrame
of results with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code>: the YYYYMMDD date string given</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'screen_line_id'</span></code>: ID of a screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code>: ID of a trip that crosses the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code>: ID of the trip’s shape</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: GTFS direction of trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'crossing_direction'</span></code>: 1 or -1; 1 indicates trip travel from the
left side to the right side of the screen line;
-1 indicates trip travel in the  opposite direction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'crossing_time'</span></code>: time, according to the GTFS schedule, that the trip
crosses the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'crossing_dist_m'</span></code>: distance along the trip shape (not subshape) of the
crossing; in meters</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">include_testing_columns</span></code>, then include the following extra columns for testing
purposes.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_id'</span></code>: ID of the simple sub-LineString S of the trip’s shape that
crosses the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_length_m'</span></code>: length of S in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'from_departure_time'</span></code>: departure time of the trip from the last stop before
the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'to_departure_time'</span></code>: departure time of the trip at from the first stop after
the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_dist_frac'</span></code>: proportion of S’s length at which the screen line
intersects S</p></li>
</ul>
<p>Notes:</p>
<ul>
<li><p>Assume the Feed’s stop times DataFrame has an accurate <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code>
column.</p></li>
<li><p>Assume that trips travel in the same direction as their shapes, an assumption
that is part of the GTFS.</p></li>
<li><p>Assume that the screen line is straight and simple.</p></li>
<li><p>The algorithm works as follows</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Find the Feed’s simple subshapes (computed via <code class="xref py py-func docutils literal notranslate"><span class="pre">shapes.split_simple()</span></code>)
that intersect the screen lines.</p></li>
<li><p>For each such subshape and screen line, compute the intersection points,
the distance of each point along the subshape, aka the <em>crossing distance</em>,
and the orientation of the screen line relative to the subshape.</p></li>
<li><p>Restrict to trips active on the given dates and for each trip associated to
an intersecting subshape above, interpolate a trip stop time
for the intersection point using the crossing distance, subshape length,
cumulative subshape length, and trip stop times.</p></li>
</ol>
</div></blockquote>
</li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.convert_dist">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">convert_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dist_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.convert_dist" title="Link to this definition"></a></dt>
<dd><p>Convert the distances recorded in the <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code>
columns of the given Feed to the given distance units.
New distance units must lie in <code class="xref py py-const docutils literal notranslate"><span class="pre">constants.DIST_UNITS</span></code>.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.create_shapes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">create_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_trips</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.create_shapes" title="Link to this definition"></a></dt>
<dd><p>Given a feed, create a shape for every trip that is missing a
shape ID.
Do this by connecting the stops on the trip with straight lines.
Return the resulting feed which has updated shapes and trips
tables.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">all_trips</span></code>, then create new shapes for all trips by
connecting stops, and remove the old shapes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.describe">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.describe" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame of various feed indicators and values,
e.g. number of routes.
Specialize some those indicators to the given YYYYMMDD sample date string,
e.g. number of routes active on the date.</p>
<p>The resulting DataFrame has the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'indicator'</span></code>: string; name of an indicator, e.g. ‘num_routes’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'value'</span></code>: value of the indicator, e.g. 27</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.list_fields">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">list_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.miscellany.list_fields" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame describing all the fields of the GTFS tables in the given feed
or in the given table if specified.</p>
<p>The resulting DataFrame has the following columns.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'table'</span></code>: name of the GTFS table, e.g. <code class="docutils literal notranslate"><span class="pre">'stops'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'column'</span></code>: name of a column in the table,
e.g. <code class="docutils literal notranslate"><span class="pre">'stop_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_values'</span></code>: number of values in the column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_nonnull_values'</span></code>: number of nonnull values in the
column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_unique_values'</span></code>: number of unique values in the
column, excluding null values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_value'</span></code>: minimum value in the column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_value'</span></code>: maximum value in the column</p></li>
</ul>
<p>If the table is not in the feed, then return an empty DataFrame
If the table is not valid, raise a ValueError</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.restrict_to_agencies">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">restrict_to_agencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agency_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.restrict_to_agencies" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.miscellany.restrict_to_routes" title="gtfs_kit.miscellany.restrict_to_routes"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_routes()</span></code></a> and
the routes with the given agency IDs.
Return the resulting feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.restrict_to_area">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">restrict_to_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.restrict_to_area" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.miscellany.restrict_to_trips" title="gtfs_kit.miscellany.restrict_to_trips"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_trips()</span></code></a>
and the trips that have at least one stop intersecting the given GeoDataFrame of
polygons.
Return the resulting feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.restrict_to_dates">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">restrict_to_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.restrict_to_dates" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.miscellany.restrict_to_trips" title="gtfs_kit.miscellany.restrict_to_trips"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_trips()</span></code></a> and
the trips active on at least one of the given dates (YYYYMMDD strings).
Return the resulting feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.restrict_to_routes">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">restrict_to_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.restrict_to_routes" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.miscellany.restrict_to_trips" title="gtfs_kit.miscellany.restrict_to_trips"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_trips()</span></code></a> and
the trips with the given route IDs.
Return the resulting feed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.miscellany.restrict_to_trips">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.miscellany.</span></span><span class="sig-name descname"><span class="pre">restrict_to_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.miscellany.restrict_to_trips" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one to only the stops,
trips, shapes, etc. used by the trips of the given IDs.
Return the resulting feed.</p>
<p>If no valid trip IDs are given, which includes the case of the empty list,
then the resulting feed will have all empty non-agency tables.</p>
<p>This function is probably more useful internally than externally.</p>
</dd></dl>

</section>
<section id="module-gtfs_kit.feed">
<span id="module-feed"></span><h2>Module feed<a class="headerlink" href="#module-gtfs_kit.feed" title="Link to this heading"></a></h2>
<p>This module defines a Feed class to represent GTFS feeds.
There is an instance attribute for every GTFS table (routes, stops, etc.),
which stores the table as a Pandas DataFrame,
or as <code class="docutils literal notranslate"><span class="pre">None</span></code> in case that table is missing.</p>
<p>The Feed class also has heaps of methods: a method to compute route stats,
a method to compute screen line counts, validations methods, etc.
To ease reading, almost all of these methods are defined in other modules and
grouped by theme (<code class="docutils literal notranslate"><span class="pre">routes.py</span></code>, <code class="docutils literal notranslate"><span class="pre">stops.py</span></code>, etc.).
These methods, or rather functions that operate on feeds, are
then imported within the Feed class.
This separation of methods unfortunately messes up slightly the <code class="docutils literal notranslate"><span class="pre">Feed</span></code> class
documentation generated by Sphinx, introducing an extra leading <code class="docutils literal notranslate"><span class="pre">feed</span></code>
parameter in the method signatures.
Ignore that extra parameter; it refers to the Feed instance,
usually called <code class="docutils literal notranslate"><span class="pre">self</span></code> and usually hidden automatically by Sphinx.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gtfs_kit.feed.</span></span><span class="sig-name descname"><span class="pre">Feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trips</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calendar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calendar_dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fare_attributes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fare_rules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.feed.Feed" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An instance of this class represents a not-necessarily-valid GTFS feed,
where GTFS tables are stored as DataFrames.
Beware that the stop times DataFrame can be big (several gigabytes),
so make sure you have enough memory to handle it.</p>
<p>Primary instance attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dist_units</span></code>: a string in <code class="xref py py-const docutils literal notranslate"><span class="pre">constants.DIST_UNITS</span></code>;
specifies the distance units of the <cite>shape_dist_traveled</cite> column values,
if present; also effects whether to display trip and route stats in
metric or imperial units</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agency</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stops</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">routes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trips</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_times</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calendar</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calendar_dates</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fare_attributes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fare_rules</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shapes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frequencies</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transfers</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed_info</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attributions</span></code></p></li>
</ul>
<p>There are also a few secondary instance attributes that are derived
from the primary attributes and are automatically updated when the
primary attributes change.
However, for this update to work, you must update the primary
attributes like this (good):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feed</span><span class="o">.</span><span class="n">trips</span><span class="p">[</span><span class="s1">&#39;route_short_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bingo&#39;</span>
<span class="n">feed</span><span class="o">.</span><span class="n">trips</span> <span class="o">=</span> <span class="n">feed</span><span class="o">.</span><span class="n">trips</span>
</pre></div>
</div>
<p>and <strong>not</strong> like this (bad):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feed</span><span class="o">.</span><span class="n">trips</span><span class="p">[</span><span class="s1">&#39;route_short_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bingo&#39;</span>
</pre></div>
</div>
<p>The first way ensures that the altered trips DataFrame is saved as
the new <code class="docutils literal notranslate"><span class="pre">trips</span></code> attribute, but the second way does not.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.aggregate_routes">
<span class="sig-name descname"><span class="pre">aggregate_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'route_short_name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_id_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'route_'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.aggregate_routes" title="Link to this definition"></a></dt>
<dd><p>Aggregate routes by route short name, say, and assign new route IDs using the
given prefix.</p>
<p>More specifically, create new route IDs with the function
<code class="xref py py-func docutils literal notranslate"><span class="pre">build_aggregate_routes_dict()</span></code> and the parameters <code class="docutils literal notranslate"><span class="pre">by</span></code> and
<code class="docutils literal notranslate"><span class="pre">route_id_prefix</span></code> and update the old route IDs to the new ones in all the relevant
Feed tables.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.aggregate_stops">
<span class="sig-name descname"><span class="pre">aggregate_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stop_code'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_id_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stop_'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.aggregate_stops" title="Link to this definition"></a></dt>
<dd><p>Aggregate stops by stop code, say, and assign new stop IDs using the
given prefix.</p>
<p>More specifically, create new stop IDs with the function
<code class="xref py py-func docutils literal notranslate"><span class="pre">build_aggregate_stops_dict()</span></code> and the parameters <code class="docutils literal notranslate"><span class="pre">by</span></code> and
<code class="docutils literal notranslate"><span class="pre">stop_id_prefix</span></code> and update the old stop IDs to the new ones in all the relevant
Feed tables.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.append_dist_to_shapes">
<span class="sig-name descname"><span class="pre">append_dist_to_shapes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.append_dist_to_shapes" title="Link to this definition"></a></dt>
<dd><p>Calculate and append the optional <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> field in
<code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> in terms of the distance units <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code>.
Return the resulting Feed.</p>
<p>As a benchmark, using this function on <a class="reference external" href="https://transitfeeds.com/p/trimet/43/1400947517">this Portland feed</a>
produces a <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column that differs by at most
0.016 km in absolute value from of the original values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.append_dist_to_stop_times">
<span class="sig-name descname"><span class="pre">append_dist_to_stop_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.append_dist_to_stop_times" title="Link to this definition"></a></dt>
<dd><p>Calculate and append the optional <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column in
<code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> in terms of the distance units <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code>.
Trips without shapes will have NaN distances.
Return the resulting Feed.
Uses <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code>, so if that is missing, then return the original feed.</p>
<p>This does not always give accurate results.
The algorithm works as follows.
Compute the <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> field by using Shapely to
measure the distance of a stop along its trip LineString.
If for a given trip this process produces a non-monotonically
increasing, hence incorrect, list of (cumulative) distances, then
fall back to estimating the distances as follows.</p>
<p>Set the first distance to 0, the last to the length of the trip shape,
and leave the remaining ones computed above.
Choose the longest increasing subsequence of that new set of
distances and use them and their corresponding departure times to linearly
interpolate the rest of the distances.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.assess_quality">
<span class="sig-name descname"><span class="pre">assess_quality</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.assess_quality" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame of various feed indicators and values,
e.g. number of trips missing shapes.</p>
<p>The resulting DataFrame has the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'indicator'</span></code>: string; name of an indicator, e.g. ‘num_routes’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'value'</span></code>: value of the indicator, e.g. 27</p></li>
</ul>
<p>This function is odd but useful for seeing roughly how broken a feed is
This function is not a GTFS validator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.build_geometry_by_shape">
<span class="sig-name descname"><span class="pre">build_geometry_by_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.build_geometry_by_shape" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary of the form
&lt;shape ID&gt; -&gt; &lt;Shapely LineString representing shape&gt;.
If the Feed has no shapes, then return the empty dictionary.
If <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>, then use local UTM coordinates; otherwise, use WGS84 coordinates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.build_geometry_by_stop">
<span class="sig-name descname"><span class="pre">build_geometry_by_stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.build_geometry_by_stop" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary of the form &lt;stop ID&gt; -&gt; &lt;Shapely Point representing stop&gt;.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.build_route_timetable">
<span class="sig-name descname"><span class="pre">build_route_timetable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.build_route_timetable" title="Link to this definition"></a></dt>
<dd><p>Return a timetable for the given route and dates (YYYYMMDD date strings).</p>
<p>Return a DataFrame with whose columns are all those in <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> plus those in
<code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> plus <code class="docutils literal notranslate"><span class="pre">'date'</span></code>.
The trip IDs are restricted to the given route ID.
The result is sorted first by date and then by grouping by
trip ID and sorting the groups by their first departure time.</p>
<p>Skip dates outside of the Feed’s dates.</p>
<p>If there is no route activity on the given dates, then return
an empty DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.build_stop_timetable">
<span class="sig-name descname"><span class="pre">build_stop_timetable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.build_stop_timetable" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame containing the timetable for the given stop ID
and dates (YYYYMMDD date strings)</p>
<p>Return a DataFrame whose columns are all those in <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> plus those in
<code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> plus <code class="docutils literal notranslate"><span class="pre">'date'</span></code>, and the stop IDs are restricted to the given
stop ID.
The result is sorted by date then departure time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.clean" title="Link to this definition"></a></dt>
<dd><p>Apply the following functions to the given Feed in order and return the resulting
Feed.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#gtfs_kit.feed.Feed.clean_ids" title="gtfs_kit.feed.Feed.clean_ids"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_ids()</span></code></a></p></li>
<li><p><a class="reference internal" href="#gtfs_kit.feed.Feed.clean_times" title="gtfs_kit.feed.Feed.clean_times"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_times()</span></code></a></p></li>
<li><p><a class="reference internal" href="#gtfs_kit.feed.Feed.clean_route_short_names" title="gtfs_kit.feed.Feed.clean_route_short_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_route_short_names()</span></code></a></p></li>
<li><p><a class="reference internal" href="#gtfs_kit.feed.Feed.drop_zombies" title="gtfs_kit.feed.Feed.drop_zombies"><code class="xref py py-func docutils literal notranslate"><span class="pre">drop_zombies()</span></code></a></p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.clean_ids">
<span class="sig-name descname"><span class="pre">clean_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.clean_ids" title="Link to this definition"></a></dt>
<dd><p>In the given Feed, strip whitespace from all string IDs and
then replace every remaining whitespace chunk with an underscore.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.clean_route_short_names">
<span class="sig-name descname"><span class="pre">clean_route_short_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.clean_route_short_names" title="Link to this definition"></a></dt>
<dd><p>In <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code>, assign ‘n/a’ to missing route short names and
strip whitespace from route short names.
Then disambiguate each route short name that is duplicated by
appending ‘-’ and its route ID.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.clean_times">
<span class="sig-name descname"><span class="pre">clean_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.clean_times" title="Link to this definition"></a></dt>
<dd><p>In the given Feed, convert H:MM:SS time strings to HH:MM:SS time
strings to make sorting by time work as expected.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_bounds">
<span class="sig-name descname"><span class="pre">compute_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">np.array</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_bounds" title="Link to this definition"></a></dt>
<dd><p>Return the bounding box (Numpy array [min longitude, min latitude, max longitude,
max latitude]) of the given Feed’s stops or of the subset of stops
specified by the given stop IDs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_busiest_date">
<span class="sig-name descname"><span class="pre">compute_busiest_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_busiest_date" title="Link to this definition"></a></dt>
<dd><p>Given a list of dates (YYYYMMDD date strings), return the first date that has the
maximum number of active trips.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_centroid">
<span class="sig-name descname"><span class="pre">compute_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">sg.Point</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_centroid" title="Link to this definition"></a></dt>
<dd><p>Return the centroid (Shapely Point) of the convex hull the given Feed’s stops
or of the subset of stops specified by the given stop IDs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_convex_hull">
<span class="sig-name descname"><span class="pre">compute_convex_hull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">sg.Polygon</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_convex_hull" title="Link to this definition"></a></dt>
<dd><p>Return a convex hull (Shapely Polygon) representing the convex hull of the given
Feed’s stops or of the subset of stops specified by the given stop IDs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_network_stats">
<span class="sig-name descname"><span class="pre">compute_network_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_route_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_network_stats" title="Link to this definition"></a></dt>
<dd><p>Compute some network stats for the given subset of trip stats, which defaults to
<cite>feed.compute_trip_stats()</cite>, and for the given dates (YYYYMMDD date stings).</p>
<p>Return a table with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code> (optional): presest if and only if <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stops'</span></code>: number of stops active on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_routes'</span></code>: number of routes active on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips that start on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips with nonnull start
times on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips with nonnull start times
and nonnull end times on the date, ignoring trips that end
after 23:59:59 on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_num_trips'</span></code>: maximum number of simultaneous trips in
service on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_start_time'</span></code>: start time of first longest period
during which the peak number of trips occurs on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_end_time'</span></code>: end time of first longest period during
which the peak number of trips occurs on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: sum of the service distances for the
active routes on the date;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: sum of the service durations for the
active routes on the date; measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: service_distance/service_duration on the
date</p></li>
</ul>
<p>Exclude dates with no active stops, which could yield the empty DataFrame.</p>
<p>The route and trip stats for date d contain stats for trips that
start on date d only and ignore trips that start on date d-1 and
end on date d.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_network_time_series">
<span class="sig-name descname"><span class="pre">compute_network_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_route_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_network_time_series" title="Link to this definition"></a></dt>
<dd><p>Compute some network stats in time series form for the given dates
(YYYYMMDD date strings) and trip stats, which defaults to
<code class="docutils literal notranslate"><span class="pre">feed.compute_trip_stats()</span></code>.
Use the given Pandas frequency string <code class="docutils literal notranslate"><span class="pre">freq</span></code> to specify the frequency of the
resulting time series, e.g. ‘5Min’.
If <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code>, then split stats by route type; otherwise don’t.</p>
<p>Return a long-form time series table with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'datetime'</span></code>: datetime object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code>: integer; present if and only if <code class="docutils literal notranslate"><span class="pre">split_route_types</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips in service during during the
time period</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips with starting during the
time period</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips ending during the
time period, ignoring the trips the end past midnight</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: distance traveled during the time
period by all trips active during the time period;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: duration traveled during the time
period by all trips active during the time period;
measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: <code class="docutils literal notranslate"><span class="pre">service_distance/service_duration</span></code> when defined; 0
otherwise</p></li>
</ul>
<p>Exclude dates that lie outside of the Feed’s date range.
If all the dates given lie outside of the Feed’s date range,
then return an empty DataFrame with the specified columns.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_route_stats">
<span class="sig-name descname"><span class="pre">compute_route_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'07:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'19:00:00'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_route_stats" title="Link to this definition"></a></dt>
<dd><p>Compute route stats for all the trips that lie in the given subset
of trip stats, which defaults to <code class="docutils literal notranslate"><span class="pre">feed.compute_trip_stats()</span></code>,
and that start on the given dates (YYYYMMDD date strings).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stats by trip direction (0 or 1).
Use the headway start and end times to specify the time period for computing
headway stats.</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: present if only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips on the route in the subset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_starts'</span></code>: number of trips on the route with
nonnull start times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trip_ends'</span></code>: number of trips on the route with nonnull
end times that end before 23:59:59</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stop_patterns'</span></code>: number of stop pattern across trips</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_loop'</span></code>: 1 if at least one of the trips on the route has
its <code class="docutils literal notranslate"><span class="pre">is_loop</span></code> field equal to 1; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_bidirectional'</span></code>: 1 if the route has trips in both
directions; 0 otherwise; present if only if not <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: start time of the earliest trip on the route</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: end time of latest trip on the route</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_headway'</span></code>: maximum of the durations (in minutes)
between trip starts on the route between
<code class="docutils literal notranslate"><span class="pre">headway_start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">headway_end_time</span></code> on the given
dates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_headway'</span></code>: minimum of the durations (in minutes)
mentioned above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_headway'</span></code>: mean of the durations (in minutes)
mentioned above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_num_trips'</span></code>: maximum number of simultaneous trips in
service (for the given direction, or for both directions when
<code class="docutils literal notranslate"><span class="pre">split_directions==False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_start_time'</span></code>: start time of first longest period
during which the peak number of trips occurs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'peak_end_time'</span></code>: end time of first longest period during
which the peak number of trips occurs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_duration'</span></code>: total of the duration of each trip on
the route in the given subset of trips; measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_distance'</span></code>: total of the distance traveled by each
trip on the route in the given subset of trips;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'service_speed'</span></code>: service_distance/service_duration when defined; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_trip_distance'</span></code>: service_distance/num_trips</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_trip_duration'</span></code>: service_duration/num_trips</p></li>
</ul>
<p>Exclude dates with no active trips, which could yield the empty DataFrame.</p>
<p>If not <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then compute each route’s stats,
except for headways, using its trips running in both directions.
For headways, (1) compute max headway by taking the max of the
max headways in both directions; (2) compute mean headway by
taking the weighted mean of the mean headways in both
directions.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
<li><p>The route stats for date d contain stats for trips that start on
date d only and ignore trips that start on date d-1 and end on
date d.</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_route_time_series">
<span class="sig-name descname"><span class="pre">compute_route_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_route_time_series" title="Link to this definition"></a></dt>
<dd><p>Compute route stats in time series form for the trips that lie in
the trip stats subset, which defaults to the output of
<a class="reference internal" href="#gtfs_kit.trips.compute_trip_stats" title="gtfs_kit.trips.compute_trip_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">trips.compute_trip_stats()</span></code></a>, and that start on the given dates
(YYYYMMDD date strings).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate each routes’s stats by trip direction.
Specify the time series frequency with a Pandas frequency string, e.g. <code class="docutils literal notranslate"><span class="pre">'5Min'</span></code>.</p>
<p>Return a time series DataFrame with the following columns.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: datetime object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">route_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction_id</span></code>: direction of route; presest if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trips</span></code>: number of trips in service on the route
at any time within the time bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trip_starts</span></code>: number of trips that start within
the time bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trip_ends</span></code>: number of trips that end within the
time bin, ignoring trips that end past midnight</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_distance</span></code>: sum of the service distance accrued
during the time bin across all trips on the route;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_duration</span></code>: sum of the service duration accrued
during the time bin across all trips on the route;
measured in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_speed</span></code>: <code class="docutils literal notranslate"><span class="pre">service_distance/service_duration</span></code>
for the route</p></li>
</ul>
<p>Exclude dates that lie outside of the Feed’s date range.
If all dates lie outside the Feed’s date range, then return an
empty DataFrame.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If you’ve already computed trip stats in your workflow, then you should pass
that table into this function to speed things up significantly.</p></li>
<li><p>See the notes for <code class="xref py py-func docutils literal notranslate"><span class="pre">compute_route_time_series_0()</span></code></p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_screen_line_counts">
<span class="sig-name descname"><span class="pre">compute_screen_line_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">screen_lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_testing_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_screen_line_counts" title="Link to this definition"></a></dt>
<dd><p>Find all the Feed trips active on the given YYYYMMDD dates that intersect
the given segment-associated screen lines of the form output by
<code class="xref py py-func docutils literal notranslate"><span class="pre">build_screen_lines()</span></code>.
Behind the scenes, use simple sub-LineStrings of the feed
to compute screen line intersections.
Using them instead of the Feed shapes avoids miscounting intersections in the
case of non-simple (self-intersecting) shapes.</p>
<p>For each trip crossing a screen line,
compute the crossing time, crossing direction, etc. and return a DataFrame
of results with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code>: the YYYYMMDD date string given</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'screen_line_id'</span></code>: ID of a screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code>: ID of a trip that crosses the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code>: ID of the trip’s shape</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: GTFS direction of trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'crossing_direction'</span></code>: 1 or -1; 1 indicates trip travel from the
left side to the right side of the screen line;
-1 indicates trip travel in the  opposite direction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'crossing_time'</span></code>: time, according to the GTFS schedule, that the trip
crosses the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'crossing_dist_m'</span></code>: distance along the trip shape (not subshape) of the
crossing; in meters</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">include_testing_columns</span></code>, then include the following extra columns for testing
purposes.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_id'</span></code>: ID of the simple sub-LineString S of the trip’s shape that
crosses the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_length_m'</span></code>: length of S in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'from_departure_time'</span></code>: departure time of the trip from the last stop before
the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'to_departure_time'</span></code>: departure time of the trip at from the first stop after
the screen line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_dist_frac'</span></code>: proportion of S’s length at which the screen line
intersects S</p></li>
</ul>
<p>Notes:</p>
<ul>
<li><p>Assume the Feed’s stop times DataFrame has an accurate <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code>
column.</p></li>
<li><p>Assume that trips travel in the same direction as their shapes, an assumption
that is part of the GTFS.</p></li>
<li><p>Assume that the screen line is straight and simple.</p></li>
<li><p>The algorithm works as follows</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Find the Feed’s simple subshapes (computed via <code class="xref py py-func docutils literal notranslate"><span class="pre">shapes.split_simple()</span></code>)
that intersect the screen lines.</p></li>
<li><p>For each such subshape and screen line, compute the intersection points,
the distance of each point along the subshape, aka the <em>crossing distance</em>,
and the orientation of the screen line relative to the subshape.</p></li>
<li><p>Restrict to trips active on the given dates and for each trip associated to
an intersecting subshape above, interpolate a trip stop time
for the intersection point using the crossing distance, subshape length,
cumulative subshape length, and trip stop times.</p></li>
</ol>
</div></blockquote>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_stop_activity">
<span class="sig-name descname"><span class="pre">compute_stop_activity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_stop_activity" title="Link to this definition"></a></dt>
<dd><p>Mark stops as active or inactive on the given dates (YYYYMMDD date strings).
A stop is <em>active</em> on a given date if some trips that starts on the
date visits the stop (possibly after midnight).</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p>stop_id</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>: 1 if the stop has at least one trip visiting it
on <code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>; 0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>: 1 if the stop has at least one trip visiting it
on <code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>; 0 otherwise</p></li>
<li><p>etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>: 1 if the stop has at least one trip visiting it
on <code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>; 0 otherwise</p></li>
</ul>
<p>If all dates lie outside the Feed period, then return an empty DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_stop_stats">
<span class="sig-name descname"><span class="pre">compute_stop_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'07:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headway_end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'19:00:00'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_stop_stats" title="Link to this definition"></a></dt>
<dd><p>Compute stats for all stops for the given dates (YYYYMMDD date strings).
Optionally, restrict to the stop IDs given.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stop stats by direction (0 or 1)
of the trips visiting the stops.
Use the headway start and end times to specify the time period for computing
headway stats.</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'date'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'stop_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: present if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_routes'</span></code>: number of routes visiting the stop
(in the given direction) on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_trips'</span></code>: number of trips visiting stop
(in the givin direction) on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_headway'</span></code>: maximum of the durations (in minutes)
between trip departures at the stop between
<code class="docutils literal notranslate"><span class="pre">headway_start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">headway_end_time</span></code> on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_headway'</span></code>: minimum of the durations (in minutes) mentioned
above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean_headway'</span></code>: mean of the durations (in minutes) mentioned
above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: earliest departure time of a trip from this stop
on the date</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: latest departure time of a trip from this stop on
the date</p></li>
</ul>
<p>Exclude dates with no active stops, which could yield the empty DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_stop_time_series">
<span class="sig-name descname"><span class="pre">compute_stop_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_stop_time_series" title="Link to this definition"></a></dt>
<dd><p>Compute time series for the given stops (defaults to all stops in Feed)
on the given dates (YYYYMMDD date strings) at the
given frequency (Pandas frequency string, e.g. <code class="docutils literal notranslate"><span class="pre">'5Min'</span></code>).
Return a long-format DataFrame with columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datetime</span></code>: datetime object for the given date and frequency chunks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction_id</span></code>: direction of route; presest if and only if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_trips</span></code>: the number of trips that visit the stop in the time bin and
have a nonnull departure time from the stop</p></li>
</ul>
<p>Exclude dates that lie outside of the Feed’s date range.
If all dates lie outside the Feed’s date range, then return an
empty DataFrame</p>
<p>If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code>, then separate the stop stats by direction (0 or 1)
of the trips visiting the stops.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The time series is computed at a one-minute frequency, then
resampled at the end to the given frequency</p></li>
<li><p>Stop times with null departure times are ignored, so the aggregate
of <code class="docutils literal notranslate"><span class="pre">num_trips</span></code> across the day could be less than the
<code class="docutils literal notranslate"><span class="pre">num_trips</span></code> column in <code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stop_stats_0()</span></code></p></li>
<li><p>All trip departure times are taken modulo 24 hours,
so routes with trips that end past 23:59:59 will have all
their stats wrap around to the early morning of the time series.</p></li>
<li><p>‘num_trips’ should be resampled with <code class="docutils literal notranslate"><span class="pre">how=np.sum</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">trips_subset</span></code> is empty, then return an empty DataFrame</p></li>
<li><p>Raise a ValueError if <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and no non-null
direction ID values present</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_trip_activity">
<span class="sig-name descname"><span class="pre">compute_trip_activity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_trip_activity" title="Link to this definition"></a></dt>
<dd><p>Mark trips as active or inactive on the given dates (YYYYMMDD date strings).
Return a table with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>: 1 if the trip is active on <code class="docutils literal notranslate"><span class="pre">dates[0]</span></code>;
0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>: 1 if the trip is active on <code class="docutils literal notranslate"><span class="pre">dates[1]</span></code>;
0 otherwise</p></li>
<li><p>etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>: 1 if the trip is active on <code class="docutils literal notranslate"><span class="pre">dates[-1]</span></code>;
0 otherwise</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">dates</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> or the empty list, then return an
empty DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.compute_trip_stats">
<span class="sig-name descname"><span class="pre">compute_trip_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_dist_from_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.compute_trip_stats" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame with the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_short_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_type'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: NaN if missing from feed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code>: NaN if missing from feed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'stop_pattern_name'</span></code>: output from <a class="reference internal" href="#gtfs_kit.feed.Feed.name_stop_patterns" title="gtfs_kit.feed.Feed.name_stop_patterns"><code class="xref py py-func docutils literal notranslate"><span class="pre">name_stop_patterns()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_stops'</span></code>: number of stops on trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_time'</span></code>: first departure time of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_time'</span></code>: last departure time of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'start_stop_id'</span></code>: stop ID of the first stop of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'end_stop_id'</span></code>: stop ID of the last stop of the trip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'is_loop'</span></code>: 1 if the start and end stop are less than 400m apart and
0 otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'distance'</span></code>: distance of the trip;
measured in kilometers if <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code> is metric;
otherwise measured in miles;
contains all <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> entries if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'duration'</span></code>: duration of the trip in hours</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'speed'</span></code>: distance/duration</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> has a <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column with at
least one non-NaN value and <code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes</span> <span class="pre">==</span> <span class="pre">False</span></code>,
then use that column to compute the distance column.
Else if <code class="docutils literal notranslate"><span class="pre">feed.shapes</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>, then compute the distance
column using the shapes and Shapely.
Otherwise, set the distances to NaN.</p>
<p>If route IDs are given, then restrict to trips on those routes.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>Assume the following feed attributes are not <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">feed.trips</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed.routes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> (optionally)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Calculating trip distances with <code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes=True</span></code>
seems pretty accurate.  For example, calculating trip distances on
<a class="reference external" href="https://transitfeeds.com/p/trimet/43/1400947517">this Portland feed</a>
using <code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes=False</span></code> and
<code class="docutils literal notranslate"><span class="pre">compute_dist_from_shapes=True</span></code>,
yields a difference of at most 0.83km from the original values.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.convert_dist">
<span class="sig-name descname"><span class="pre">convert_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_dist_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.convert_dist" title="Link to this definition"></a></dt>
<dd><p>Convert the distances recorded in the <code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code>
columns of the given Feed to the given distance units.
New distance units must lie in <code class="xref py py-const docutils literal notranslate"><span class="pre">constants.DIST_UNITS</span></code>.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.copy" title="Link to this definition"></a></dt>
<dd><p>Return a copy of this feed, that is, a feed with all the same
attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.create_shapes">
<span class="sig-name descname"><span class="pre">create_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_trips</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.create_shapes" title="Link to this definition"></a></dt>
<dd><p>Given a feed, create a shape for every trip that is missing a
shape ID.
Do this by connecting the stops on the trip with straight lines.
Return the resulting feed which has updated shapes and trips
tables.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">all_trips</span></code>, then create new shapes for all trips by
connecting stops, and remove the old shapes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.describe" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame of various feed indicators and values,
e.g. number of routes.
Specialize some those indicators to the given YYYYMMDD sample date string,
e.g. number of routes active on the date.</p>
<p>The resulting DataFrame has the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'indicator'</span></code>: string; name of an indicator, e.g. ‘num_routes’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'value'</span></code>: value of the indicator, e.g. 27</p></li>
</ul>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.dist_units">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dist_units</span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.dist_units" title="Link to this definition"></a></dt>
<dd><p>The distance units of the Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.drop_invalid_columns">
<span class="sig-name descname"><span class="pre">drop_invalid_columns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.drop_invalid_columns" title="Link to this definition"></a></dt>
<dd><p>Drop all DataFrame columns of the given Feed that are not
listed in the GTFS.
Return the resulting Feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.drop_zombies">
<span class="sig-name descname"><span class="pre">drop_zombies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.drop_zombies" title="Link to this definition"></a></dt>
<dd><p>In the given Feed, do the following in order and return the resulting Feed.</p>
<ol class="arabic simple">
<li><p>Drop agencies with no routes.</p></li>
<li><p>Drop stops of location type 0 or NaN with no stop times.</p></li>
<li><p>Remove undefined parent stations from the <code class="docutils literal notranslate"><span class="pre">parent_station</span></code> column.</p></li>
<li><p>Drop trips with no stop times.</p></li>
<li><p>Drop shapes with no trips.</p></li>
<li><p>Drop routes with no trips.</p></li>
<li><p>Drop services with no trips.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.extend_id">
<span class="sig-name descname"><span class="pre">extend_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.extend_id" title="Link to this definition"></a></dt>
<dd><p>Add a prefix (if <code class="docutils literal notranslate"><span class="pre">prefix</span></code>) or a suffix (otherwise) to all values of column
<code class="docutils literal notranslate"><span class="pre">id_col</span></code> across all tables of this Feed.
This can be helpful when preparing to merge multiple GTFS feeds with colliding
route IDs, say.</p>
<p>Raises a ValueError if <code class="docutils literal notranslate"><span class="pre">id_col</span></code> values are strings,
e.g. if <code class="docutils literal notranslate"><span class="pre">id_col</span></code> is ‘direction_id’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.geometrize_shapes">
<span class="sig-name descname"><span class="pre">geometrize_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.geometrize_shapes" title="Link to this definition"></a></dt>
<dd><p>Given a GTFS shapes DataFrame, convert it to a GeoDataFrame of LineStrings
and return the result, which will no longer have the columns
<code class="docutils literal notranslate"><span class="pre">'shape_pt_sequence'</span></code>, <code class="docutils literal notranslate"><span class="pre">'shape_pt_lon'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'shape_pt_lat'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'shape_dist_traveled'</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>, then use local UTM coordinates for the geometries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.geometrize_stops">
<span class="sig-name descname"><span class="pre">geometrize_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.geometrize_stops" title="Link to this definition"></a></dt>
<dd><p>Given a stops DataFrame, convert it to a GeoPandas GeoDataFrame of Points
and return the result, which will no longer have the columns <code class="docutils literal notranslate"><span class="pre">'stop_lon'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'stop_lat'</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_active_services">
<span class="sig-name descname"><span class="pre">get_active_services</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_active_services" title="Link to this definition"></a></dt>
<dd><p>Given a Feed and a date string in YYYYMMDD format,
return the list of service IDs that are active on the date.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_dates">
<span class="sig-name descname"><span class="pre">get_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_date_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_dates" title="Link to this definition"></a></dt>
<dd><p>Return a list of YYYYMMDD date strings for which the given Feed is valid,
which could be the empty list if the Feed has no calendar information.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_date_obj</span></code>, then return datetime.date objects instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_first_week">
<span class="sig-name descname"><span class="pre">get_first_week</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_date_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_first_week" title="Link to this definition"></a></dt>
<dd><p>Return a list of YYYYMMDD date strings for the first Monday–Sunday
week (or initial segment thereof) for which the given Feed is valid.
If the feed has no Mondays, then return the empty list.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_date_obj</span></code>, then return date objects, otherwise return date strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_routes">
<span class="sig-name descname"><span class="pre">get_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_routes" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code> or a subset thereof.
If a YYYYMMDD date string is given, then restrict routes to only those active on
the date.
If a HH:MM:SS time string is given, possibly with HH &gt; 23, then restrict routes
to only those active during the time.</p>
<p>Given a Feed, return a GeoDataFrame with all the columns of <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code>
plus a geometry column of (Multi)LineStrings, each of which represents the
corresponding routes’s shape.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then return a GeoDataFrame with all the columns of <code class="docutils literal notranslate"><span class="pre">feed.routes</span></code>
plus a geometry column of (Multi)LineStrings, each of which represents the
corresponding routes’s union of trip shapes.
The GeoDataFrame will have a local UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>; otherwise it will have
CRS WGS84.
If <code class="docutils literal notranslate"><span class="pre">split_directions</span></code> and <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then add the column <code class="docutils literal notranslate"><span class="pre">direction_id</span></code> and
split each route into the union of its direction 0 shapes
and the union of its direction 1 shapes.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_shapes">
<span class="sig-name descname"><span class="pre">get_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">gpd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_shapes" title="Link to this definition"></a></dt>
<dd><p>Get the shapes DataFrame for the given feed, which could be <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then return it as GeoDataFrame with a ‘geometry’ column
of linestrings and no ‘shape_pt_sequence’, ‘shape_pt_lon’, ‘shape_pt_lat’,
‘shape_dist_traveled’ columns.
The GeoDataFrame will have a UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>; otherwise it will have a
WGS84 CRS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_shapes_intersecting_geometry">
<span class="sig-name descname"><span class="pre">get_shapes_intersecting_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sg.base.BaseGeometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_shapes_intersecting_geometry" title="Link to this definition"></a></dt>
<dd><p>If the Feed has no shapes, then return None.
Otherwise, return the subset of <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> that contains all shapes that
intersect the given Shapely WGS84 geometry, e.g. a Polygon or LineString.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then return the shapes as a GeoDataFrame.
Specifying <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> will skip the first step of the
algorithm, namely, geometrizing <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_start_and_end_times">
<span class="sig-name descname"><span class="pre">get_start_and_end_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_start_and_end_times" title="Link to this definition"></a></dt>
<dd><p>Return the first departure time and last arrival time
(HH:MM:SS time strings) listed in <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code>, respectively.
Restrict to the given date (YYYYMMDD string) if specified.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_stop_times">
<span class="sig-name descname"><span class="pre">get_stop_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_stop_times" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code>.
If a date (YYYYMMDD date string) is given, then subset the result to only those
stop times with trips active on the date.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_stops">
<span class="sig-name descname"><span class="pre">get_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_stations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_stops" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.stops</span></code>.
If a YYYYMMDD date string is given, then subset to stops
active (visited by trips) on that date.
If trip IDs are given, then subset further to stops visited by those
trips.
If route IDs are given, then ignore the trip IDs and subset further
to stops visited by those routes.
If <code class="docutils literal notranslate"><span class="pre">in_stations</span></code>, then subset further stops in stations if station data
is available.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code>, then return the result as a GeoDataFrame with a ‘geometry’
column of points instead of ‘stop_lat’ and ‘stop_lon’ columns.
The GeoDataFrame will have a UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code> and a WGS84 CRS otherwise.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_stops_in_area">
<span class="sig-name descname"><span class="pre">get_stops_in_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_stops_in_area" title="Link to this definition"></a></dt>
<dd><p>Return the subset of <code class="docutils literal notranslate"><span class="pre">feed.stops</span></code> that contains all stops that lie
within the given GeoDataFrame of polygons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_trips">
<span class="sig-name descname"><span class="pre">get_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_utm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_trips" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code>.
If date (YYYYMMDD date string) is given then subset the result to trips
that start on that date.
If a time (HH:MM:SS string, possibly with HH &gt; 23) is given in addition to a date,
then further subset the result to trips in service at that time.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is not None, then return the trips as a
GeoDataFrame of LineStrings representating trip shapes.
Use local UTM CRS if <code class="docutils literal notranslate"><span class="pre">use_utm</span></code>; otherwise it the WGS84 CRS.
If <code class="docutils literal notranslate"><span class="pre">as_gdf</span></code> and <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.get_week">
<span class="sig-name descname"><span class="pre">get_week</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_date_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.get_week" title="Link to this definition"></a></dt>
<dd><p>Given a Feed and a positive integer <code class="docutils literal notranslate"><span class="pre">k</span></code>,
return a list of YYYYMMDD date strings corresponding to the kth Monday–Sunday week
(or initial segment thereof) for which the Feed is valid.
For example, k=1 returns the first Monday–Sunday week (or initial segment thereof).
If the Feed does not have k Mondays, then return the empty list.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">as_date_obj</span></code>, then return datetime.date objects instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.list_fields">
<span class="sig-name descname"><span class="pre">list_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.list_fields" title="Link to this definition"></a></dt>
<dd><p>Return a DataFrame describing all the fields of the GTFS tables in the given feed
or in the given table if specified.</p>
<p>The resulting DataFrame has the following columns.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'table'</span></code>: name of the GTFS table, e.g. <code class="docutils literal notranslate"><span class="pre">'stops'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'column'</span></code>: name of a column in the table,
e.g. <code class="docutils literal notranslate"><span class="pre">'stop_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_values'</span></code>: number of values in the column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_nonnull_values'</span></code>: number of nonnull values in the
column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'num_unique_values'</span></code>: number of unique values in the
column, excluding null values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_value'</span></code>: minimum value in the column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'max_value'</span></code>: maximum value in the column</p></li>
</ul>
<p>If the table is not in the feed, then return an empty DataFrame
If the table is not valid, raise a ValueError</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.locate_trips">
<span class="sig-name descname"><span class="pre">locate_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.locate_trips" title="Link to this definition"></a></dt>
<dd><p>Return the positions of all trips active on the
given date (YYYYMMDD date string) and times (HH:MM:SS time strings,
possibly with HH &gt; 23).</p>
<p>Return a DataFrame with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'trip_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'route_id'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direction_id'</span></code>: all NaNs if <code class="docutils literal notranslate"><span class="pre">feed.trips.direction_id</span></code> is
missing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'time'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rel_dist'</span></code>: number between 0 (start) and 1 (end)
indicating the relative distance of the trip along its path</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lon'</span></code>: longitude of trip at given time</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lat'</span></code>: latitude of trip at given time</p></li>
</ul>
<p>Assume <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code> has an accurate
<code class="docutils literal notranslate"><span class="pre">shape_dist_traveled</span></code> column.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.map_routes">
<span class="sig-name descname"><span class="pre">map_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_short_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_palette</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['#66c2a5',</span> <span class="pre">'#fc8d62',</span> <span class="pre">'#8da0cb',</span> <span class="pre">'#e78ac3',</span> <span class="pre">'#a6d854',</span> <span class="pre">'#ffd92f',</span> <span class="pre">'#e5c494',</span> <span class="pre">'#b3b3b3']</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.feed.Feed.map_routes" title="Link to this definition"></a></dt>
<dd><p>Return a Folium map showing the given routes and (optionally) their stops.
At least one of <code class="docutils literal notranslate"><span class="pre">route_ids</span></code> and <code class="docutils literal notranslate"><span class="pre">route_short_names</span></code> must be given.
If both are given, then combine the two into a single set of routes.
If any of the given route IDs are not found in the feed, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.map_stops">
<span class="sig-name descname"><span class="pre">map_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">'#fc8d62',</span> <span class="pre">'fill':</span> <span class="pre">'true',</span> <span class="pre">'fillOpacity':</span> <span class="pre">0.75,</span> <span class="pre">'radius':</span> <span class="pre">8,</span> <span class="pre">'weight':</span> <span class="pre">1}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.feed.Feed.map_stops" title="Link to this definition"></a></dt>
<dd><p>Return a Folium map showing the given stops of this Feed.
If some of the given stop IDs are not found in the feed, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.map_trips">
<span class="sig-name descname"><span class="pre">map_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_palette</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['#66c2a5',</span> <span class="pre">'#fc8d62',</span> <span class="pre">'#8da0cb',</span> <span class="pre">'#e78ac3',</span> <span class="pre">'#a6d854',</span> <span class="pre">'#ffd92f',</span> <span class="pre">'#e5c494',</span> <span class="pre">'#b3b3b3']</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gtfs_kit.feed.Feed.map_trips" title="Link to this definition"></a></dt>
<dd><p>Return a Folium map showing the given trips and (optionally)
their stops.
If any of the given trip IDs are not found in the feed, then raise a ValueError.
If <code class="docutils literal notranslate"><span class="pre">include_direction</span></code>, then use the Folium plugin PolyLineTextPath to draw arrows
on each trip polyline indicating its direction of travel; this fails to work in some
browsers, such as Brave 0.68.132.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.name_stop_patterns">
<span class="sig-name descname"><span class="pre">name_stop_patterns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.name_stop_patterns" title="Link to this definition"></a></dt>
<dd><p>For each (route ID, direction ID) pair, find the distinct stop patterns of its
trips, and assign them each an integer <em>pattern rank</em> based on the stop pattern’s
frequency rank, where 1 is the most frequent stop pattern, 2 is the second most
frequent, etc.
Return the DataFrame <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> with the additional column
<code class="docutils literal notranslate"><span class="pre">stop_pattern_name</span></code>, which equals the trip’s ‘direction_id’ concatenated with a
dash and its stop pattern rank.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">feed.trips</span></code> has no ‘direction_id’ column, then temporarily create one equal
to all zeros, proceed as above, then delete the column.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.restrict_to_agencies">
<span class="sig-name descname"><span class="pre">restrict_to_agencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agency_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.restrict_to_agencies" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.feed.Feed.restrict_to_routes" title="gtfs_kit.feed.Feed.restrict_to_routes"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_routes()</span></code></a> and
the routes with the given agency IDs.
Return the resulting feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.restrict_to_area">
<span class="sig-name descname"><span class="pre">restrict_to_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gpd.GeoDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.restrict_to_area" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.feed.Feed.restrict_to_trips" title="gtfs_kit.feed.Feed.restrict_to_trips"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_trips()</span></code></a>
and the trips that have at least one stop intersecting the given GeoDataFrame of
polygons.
Return the resulting feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.restrict_to_dates">
<span class="sig-name descname"><span class="pre">restrict_to_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.restrict_to_dates" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.feed.Feed.restrict_to_trips" title="gtfs_kit.feed.Feed.restrict_to_trips"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_trips()</span></code></a> and
the trips active on at least one of the given dates (YYYYMMDD strings).
Return the resulting feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.restrict_to_routes">
<span class="sig-name descname"><span class="pre">restrict_to_routes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.restrict_to_routes" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one via <a class="reference internal" href="#gtfs_kit.feed.Feed.restrict_to_trips" title="gtfs_kit.feed.Feed.restrict_to_trips"><code class="xref py py-func docutils literal notranslate"><span class="pre">restrict_to_trips()</span></code></a> and
the trips with the given route IDs.
Return the resulting feed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.restrict_to_trips">
<span class="sig-name descname"><span class="pre">restrict_to_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.restrict_to_trips" title="Link to this definition"></a></dt>
<dd><p>Build a new feed by restricting this one to only the stops,
trips, shapes, etc. used by the trips of the given IDs.
Return the resulting feed.</p>
<p>If no valid trip IDs are given, which includes the case of the empty list,
then the resulting feed will have all empty non-agency tables.</p>
<p>This function is probably more useful internally than externally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.routes_to_geojson">
<span class="sig-name descname"><span class="pre">routes_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_short_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.routes_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection (in WGS84 coordinates) of MultiLineString
features representing this Feed’s routes.</p>
<p>If an iterable of route IDs or route short names is given, then subset to the
union of those routes, which could yield an empty FeatureCollection in case of
all invalid route IDs / route short names.
If <code class="docutils literal notranslate"><span class="pre">include_stops</span></code>, then include the route stops as Point features.
If the Feed has no shapes, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.shapes_to_geojson">
<span class="sig-name descname"><span class="pre">shapes_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.shapes_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection of LineString features
representing <code class="docutils literal notranslate"><span class="pre">feed.shapes</span></code>.
If the Feed has no shapes, then the features will be an empty list.
The coordinates reference system is the default one for GeoJSON,
namely WGS84.</p>
<p>If an iterable of shape IDs is given, then subset to those shapes.
If the subset is empty, then return a FeatureCollection with an empty list of
features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.split_simple">
<span class="sig-name descname"><span class="pre">split_simple</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.split_simple" title="Link to this definition"></a></dt>
<dd><p>Given a GeoDataFrame of GTFS shapes of the form output by <a class="reference internal" href="#gtfs_kit.feed.Feed.geometrize_shapes" title="gtfs_kit.feed.Feed.geometrize_shapes"><code class="xref py py-func docutils literal notranslate"><span class="pre">geometrize_shapes()</span></code></a>
with possibly non-WGS84 coordinates,
split each non-simple LineString into large simple (non-self-intersecting)
sub-LineStrings, and leave the simple LineStrings as is.</p>
<p>Return a GeoDataFrame in the coordinates of <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> with the columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'shape_id'</span></code>: GTFS shape ID for a LineString L</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_id'</span></code>: a unique identifier of a simple sub-LineString S of L</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_sequence'</span></code>: integer; indicates the order of S when joining up
all simple sub-LineStrings to form L</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'subshape_length_m'</span></code>: the length of S in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cum_length_m'</span></code>: the length S plus the lengths of sub-LineStrings of L
that come before S; in meters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'geometry'</span></code>: LineString geometry corresponding to S</p></li>
</ul>
<p>Within each ‘shape_id’ group, the subshapes will be sorted increasingly by
‘subshape_sequence’.</p>
<p class="rubric">Notes</p>
<ul>
<li><p>Simplicity checks and splitting are done in local UTM coordinates.
Converting back to original coordinates can introduce rounding errors and
non-simplicities.
So test this function with a <code class="docutils literal notranslate"><span class="pre">shapes_g</span></code> in local UTM coordinates.</p></li>
<li><p>By construction, for each given LineString L with simple sub-LineStrings
S_i, we have the inequality</p>
<blockquote>
<div><p>sum over i of length(S_i) &lt;= length(L),</p>
</div></blockquote>
<p>where the lengths are expressed in meters.</p>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.stop_times_to_geojson">
<span class="sig-name descname"><span class="pre">stop_times_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.stop_times_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection (in WGS84 coordinates) of Point features
representing all the trip-stop pairs in <code class="docutils literal notranslate"><span class="pre">feed.stop_times</span></code>.</p>
<p>For every trip, drop duplicate stop IDs within that trip.
In particular, a looping trip will lack its final stop.</p>
<p>If an iterable of trip IDs is given, then subset to those trips, which could yield
an empty FeatureCollection in case of all invalid trips.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.stops_to_geojson">
<span class="sig-name descname"><span class="pre">stops_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.stops_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection of Point features
representing all the stops in <code class="docutils literal notranslate"><span class="pre">feed.stops</span></code>.
The coordinates reference system is the default one for GeoJSON,
namely WGS84.</p>
<p>If an iterable of stop IDs is given, then subset to those stops.
If some of the given stop IDs are not found in the feed, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.subset_dates">
<span class="sig-name descname"><span class="pre">subset_dates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.subset_dates" title="Link to this definition"></a></dt>
<dd><p>Given a Feed and a list of YYYYMMDD date strings,
return the sorted sublist of dates that lie in the Feed’s dates
(the output <code class="xref py py-func docutils literal notranslate"><span class="pre">feed.get_dates()</span></code>).
Could be an empty list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndigits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.to_file" title="Link to this definition"></a></dt>
<dd><p>Write this Feed to the given path.
If the path ends in ‘.zip’, then write the feed as a zip archive.
Otherwise assume the path is a directory, and write the feed as a
collection of CSV files to that directory, creating the directory
if it does not exist.
Round all decimals to <code class="docutils literal notranslate"><span class="pre">ndigits</span></code> decimal places, if given.
All distances will be the distance units <code class="docutils literal notranslate"><span class="pre">feed.dist_units</span></code>.
By the way, 6 decimal degrees of latitude and longitude is enough to locate
an individual cat.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.trips_to_geojson">
<span class="sig-name descname"><span class="pre">trips_to_geojson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_stops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.trips_to_geojson" title="Link to this definition"></a></dt>
<dd><p>Return a GeoJSON FeatureCollection (in WGS84 coordinates) of LineString features
representing this Feed’s trips.</p>
<p>If an iterable of trip IDs is given, then subset to those trips, which could yield
an empty FeatureCollection in case all trip IDs are invalid.
If <code class="docutils literal notranslate"><span class="pre">include_stops</span></code>, then include the trip stops as Point features.
If the Feed has no shapes, then raise a ValueError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gtfs_kit.feed.Feed.ungeometrize_stops">
<span class="sig-name descname"><span class="pre">ungeometrize_stops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.Feed.ungeometrize_stops" title="Link to this definition"></a></dt>
<dd><p>The inverse of <a class="reference internal" href="#gtfs_kit.feed.Feed.geometrize_stops" title="gtfs_kit.feed.Feed.geometrize_stops"><code class="xref py py-func docutils literal notranslate"><span class="pre">geometrize_stops()</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">stops_g</span></code> is in UTM coordinates (has a UTM CRS property),
then convert those UTM coordinates back to WGS84 coordinates,
which is the standard for a GTFS shapes table.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.feed.list_feed">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.feed.</span></span><span class="sig-name descname"><span class="pre">list_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#gtfs_kit.feed.list_feed" title="Link to this definition"></a></dt>
<dd><p>Given a path (string or Path object) to a GTFS zip file or
directory, record the file names and file sizes of the contents,
and return the result in a DataFrame with the columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'file_name'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'file_size'</span></code></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gtfs_kit.feed.read_feed">
<span class="sig-prename descclassname"><span class="pre">gtfs_kit.feed.</span></span><span class="sig-name descname"><span class="pre">read_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_or_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gtfs_kit.feed.Feed" title="gtfs_kit.feed.Feed"><span class="pre">Feed</span></a></span></span><a class="headerlink" href="#gtfs_kit.feed.read_feed" title="Link to this definition"></a></dt>
<dd><p>Create a Feed instance from the given path or URL and given distance units.
If the path exists, then call <code class="xref py py-func docutils literal notranslate"><span class="pre">_read_feed_from_path()</span></code>.
Else if the URL has OK status according to Requests, then call
<code class="xref py py-func docutils literal notranslate"><span class="pre">_read_feed_from_url()</span></code>.
Else raise a ValueError.</p>
<p>Notes:</p>
<ul class="simple">
<li><p>Ignore non-GTFS files in the feed</p></li>
<li><p>Automatically strip whitespace from the column names in GTFS files</p></li>
</ul>
</dd></dl>

</section>
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>